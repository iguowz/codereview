<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitÂ¢ûÈáè‰ª£Á†ÅÊô∫ËÉΩÂÆ°Êü•‰∏éÊµãËØïÁî®‰æãÁîüÊàêÁ≥ªÁªü</title>

    <!-- Element Plus CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/element-plus.css') }}">
    <!-- Vue 3 -->
    <script src="{{ url_for('static', filename='js/vue.global.js') }}"></script>
    <!-- Element Plus -->
    <script src="{{ url_for('static', filename='js/element-plus.js') }}"></script>
    <!-- Axios -->
    <script src="{{ url_for('static', filename='js/axios.min.js') }}"></script>
    <!-- Chart.js -->
    <script src="{{ url_for('static', filename='js/chart.js') }}"></script>
    <!-- ElementPlus ÂõæÊ†áÂ∫ì index.iife.min.js -->
    <script src="{{ url_for('static', filename='js/index.iife.min.js') }}"></script>

    
    <style>
        :root {
            /* ‰∏ªËâ≤Ë∞ÉÁ≥ªÁªü */
            --el-color-primary: #6366f1;
            --el-color-success: #10b981;
            --el-color-warning: #f59e0b;
            --el-color-danger: #ef4444;
            --el-color-info: #06b6d4;
            
            /* ‰∏≠ÊÄßËâ≤Ë∞É */
            --color-gray-50: #f9fafb;
            --color-gray-100: #f3f4f6;
            --color-gray-200: #e5e7eb;
            --color-gray-300: #d1d5db;
            --color-gray-400: #9ca3af;
            --color-gray-500: #6b7280;
            --color-gray-600: #4b5563;
            --color-gray-700: #374151;
            --color-gray-800: #1f2937;
            --color-gray-900: #111827;
            
            /* Â∞∫ÂØ∏Á≥ªÁªü */
            --card-radius: 12px;
            --card-radius-sm: 8px;
            --card-radius-lg: 16px;
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            
            /* Èò¥ÂΩ±Á≥ªÁªü */
            --card-shadow: 0 10px 30px rgba(0,0,0,0.06);
            --soft-shadow: 0 6px 20px rgba(0,0,0,0.05);
            --hover-shadow: 0 8px 25px rgba(0,0,0,0.1);
            --focus-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            
            /* ËøáÊ∏°Âä®Áîª */
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }
        body {
            margin: 0;
            padding: var(--spacing-lg);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(180deg, var(--color-gray-50) 0%, #f3f6ff 35%, #f9fbff 100%);
            color: var(--color-gray-800);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #fff;
            border-radius: var(--card-radius);
            box-shadow: var(--card-shadow);
            padding: var(--spacing-xl) var(--spacing-xl) calc(var(--spacing-xl) + var(--spacing-sm));
            border: 1px solid var(--color-gray-200);
        }
        
        .header {
            text-align: center;
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-sm);
            position: relative;
        }
        
        .header h1 {
            color: var(--color-gray-800);
            margin: 0;
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.025em;
            background: linear-gradient(135deg, var(--color-gray-800) 0%, var(--el-color-primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            margin: var(--spacing-xs) 0 0;
            color: var(--color-gray-600);
            font-size: 16px;
            font-weight: 500;
        }
        
        .history-entry {
            position: absolute;
            top: 4px;
            right: 0;
            border-radius: 8px;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(64, 158, 255, 0.2);
            transition: all 0.3s ease;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
        }
        
        .history-entry * {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
        }
        
        .history-entry .el-icon {
            margin-right: 4px !important;
        }
        
        .history-entry:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(64, 158, 255, 0.3);
        }
        
        .selection-area {
            background: #fff;
            padding: var(--spacing-lg);
            border-radius: var(--card-radius-sm);
            margin-bottom: var(--spacing-lg);
            border: 1px solid var(--color-gray-200);
            box-shadow: var(--soft-shadow);
            transition: var(--transition-normal);
        }
        
        .selection-area:hover {
            box-shadow: var(--hover-shadow);
            border-color: var(--color-gray-300);
        }
        
        .operation-area {
            text-align: center;
            margin-bottom: 24px;
        }
        
        .result-area {
            min-height: 400px;
        }
        
        .loading {
            text-align: center;
            padding: 40px 20px;
        }
        
        .issue-card {
            margin-bottom: 12px;
            border-left: 4px solid transparent;
        }

        .issue-card:hover {
            transform: translateY(-1px);
            transition: all .2s ease;
            box-shadow: var(--soft-shadow);
        }
        
        .severity-critical {
            background-color: #fff5f5;
            border-color: #f56c6c;
            border-left-color: #f56c6c;
        }
        
        .severity-high {
            background-color: #fff8ed;
            border-color: #e6a23c;
            border-left-color: #e6a23c;
        }
        
        .severity-medium {
            background-color: #f5f9ff;
            border-color: #409eff;
            border-left-color: #409eff;
        }
        
        .severity-low {
            background-color: #f4fff7;
            border-color: #67c23a;
            border-left-color: #67c23a;
        }
        
        .code-block {
            background: #0b1021;
            color: #e2e8f0;
            border: 1px solid #0f172a;
            border-radius: 8px;
            padding: 14px 14px 12px;
            margin: 12px 0 6px;
            position: relative;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 13px;
            line-height: 1.6;
        }
        
        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            opacity: .9;
        }
        
        .scenario-card {
            margin-bottom: 16px;
        }

        .task-card { margin-bottom: 12px; }
        .task-meta { color: #909399; font-size: 12px; margin-top: 6px; }

        .el-button--primary {
            box-shadow: 0 6px 16px rgba(99,102,241,0.25);
            border-radius: var(--card-radius-sm);
            transition: var(--transition-normal);
        }
        
        .el-button--primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99,102,241,0.3);
        }

        .el-alert { 
            border-radius: var(--card-radius-sm);
            border: 1px solid var(--color-gray-200);
        }
        
        .el-form-item__label {
            color: var(--color-gray-700);
            font-weight: 600;
        }
        
        .el-form-item__content {
            color: var(--color-gray-800);
        }

        /* ÂçïÂÖÉÊµãËØïÁî®‰æãÊ†∑Âºè */
        .unit-test-card {
            margin-bottom: 20px;
            border-radius: 10px;
        }

        .test-description {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 0 4px 4px 0;
            border-left: 4px solid #409eff;
        }
        
        .test-description-content {
            line-height: 1.4;
            color: #5a6c7d;
        }
        
        .test-description-content br {
            line-height: 0.8;
            margin: 2px 0;
        }
        
        .test-step {
            margin: 4px 0;
            padding: 2px 0;
            line-height: 1.3;
        }
        
        .test-line {
            margin: 2px 0;
            padding: 1px 0;
            line-height: 1.3;
        }
        
        .test-keyword {
            color: #409eff;
            font-weight: 500;
        }

        .test-description h4 {
            margin: 0 0 5px 0;
            color: #409eff;
            font-size: 16px;
        }

        .test-description p {
            margin: 0;
            line-height: 1.6;
            color: #606266;
        }

        /* Âú∫ÊôØÊµãËØïÁî®‰æãÊ®°ÂùóÊ†∑Âºè */
        .module-group-card {
            margin-bottom: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 12px 0 rgba(0,0,0,0.08);
        }

        .module-header {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            font-weight: bold;
        }

        .module-name {
            color: #409eff;
            flex: 1;
        }

        .scenario-card {
            margin-bottom: 15px;
            border-radius: 8px;
            border: 1px solid #e4e7ed;
            transition: all 0.3s ease;
        }

        .scenario-card:hover {
            box-shadow: 0 4px 20px 0 rgba(0,0,0,0.12);
            transform: translateY(-2px);
        }
        
        /* ÁªüËÆ°Êï∞ÊçÆÊ†∑Âºè */
        .statistics-overview {
            margin-bottom: 20px;
        }
        
        .stat-card {
            border-radius: var(--card-radius);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            transition: var(--transition-normal);
            box-shadow: var(--soft-shadow);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
        }
        
        .stat-card.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .stat-card.warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .stat-card.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .stat-card.info {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .quality-score {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-radius: var(--card-radius);
            color: white;
            margin-bottom: 20px;
        }
        
        .quality-score .score {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .quality-score .label {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .chart-container {
            background: white;
            border-radius: var(--card-radius);
            padding: 20px;
            box-shadow: var(--soft-shadow);
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #374151;
            text-align: center;
        }
        
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        
        .chart-wrapper canvas {
            max-height: 100% !important;
        }
        
        .issue-severity-critical {
            color: #ef4444;
            font-weight: bold;
        }
        
        .issue-severity-high {
            color: #f59e0b;
            font-weight: bold;
        }
        
        .issue-severity-medium {
            color: #06b6d4;
            font-weight: 500;
        }
        
        .issue-severity-low {
            color: #10b981;
            font-weight: 500;
        }
        
        .language-tag {
            display: inline-block;
            background: #f3f4f6;
            color: #374151;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.8rem;
            margin-right: 8px;
            margin-bottom: 4px;
        }
        
        /* Á¥ßÂáëÁªüËÆ°Âç°ÁâáÊ†∑Âºè */
        .stat-card-compact {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            color: white;
            border: none;
            margin-bottom: 8px;
        }
        
        .stat-card-compact .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .stat-card-compact .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .stat-card-compact.danger { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .stat-card-compact.success { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .stat-card-compact.info { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        .stat-card-compact.warning { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        
        /* Á¥ßÂáëÂõæË°®ÂÆπÂô®Ê†∑Âºè */
        .chart-container-compact {
            background: white;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }
        
        .chart-title-compact {
            font-size: 0.85rem;
            font-weight: 600;
            color: #374151;
            text-align: center;
            margin-bottom: 8px;
        }
        
        .chart-wrapper-compact {
            position: relative;
            height: 120px;
        }
        
        .chart-wrapper-compact canvas {
            max-height: 100% !important;
        }
        
        .language-compact {
            text-align: center;
            padding: 10px 5px;
        }
        
        .language-tag-small {
            display: inline-block;
            background: #e5e7eb;
            color: #374151;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            margin: 2px;
        }
        
        .no-data-compact {
            color: #9ca3af;
            font-size: 0.8rem;
            padding: 10px;
        }
        
        /* Âú∫ÊôØÊµãËØïÊ†∑ÂºèÊîπËøõ */
        .scenario-title-row {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
        }
        
        .scenario-title-row .scenario-title {
            flex: 1;
            font-weight: 500;
            color: #374151;
        }
        
        .scenario-details {
            padding: 10px 0;
        }
        
        .detail-row {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .detail-row strong {
            color: #374151;
            font-size: 0.9rem;
        }
        
        .detail-row span {
            margin-left: 8px;
            color: #6b7280;
        }
        
        .steps-content {
            margin-left: 8px;
            color: #6b7280;
            white-space: pre-wrap;
        }
        
        /* Diff‰ª£Á†ÅÂ±ïÁ§∫Ê†∑Âºè */
        .diff-card {
            border: 1px solid #e4e7ed;
            margin-bottom: 15px;
        }
        
        .diff-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0;
        }
        
        .diff-block {
            background-color: #f8f9fa;
            border-radius: 6px;
            overflow-x: auto;
            max-height: 400px;
            margin: 0;
        }
        
        .diff-block pre {
            margin: 0;
            padding: 15px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.4;
            white-space: pre;
            color: #2c3e50;
        }
        
        /* Âú∫ÊôØÊµãËØïÂç°ÁâáÁæéÂåñÊ†∑Âºè */
        .scenario-card {
            border-radius: 10px;
            border: 1px solid #e4e7ed;
            transition: all 0.3s ease;
        }
        
        .scenario-card:hover {
            border-color: #409eff;
            transform: translateY(-2px);
        }
        
        .scenario-title-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .scenario-title {
            font-weight: 600;
            color: #2c3e50;
            font-size: 15px;
            line-height: 1.4;
        }
        
        .scenario-tags {
            display: flex;
            gap: 6px;
        }
        
        .scenario-section {
            margin-bottom: 15px;
        }
        
        .scenario-section:last-child {
            margin-bottom: 0;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0 0 8px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .section-content {
            margin: 0;
        }
        
        .section-content p {
            margin: 0;
            line-height: 1.6;
            color: #5a6c7d;
        }
        
        .content-list {
            margin: 0;
            padding-left: 20px;
            color: #5a6c7d;
            line-height: 1.6;
        }
        
        .content-list li {
            margin-bottom: 4px;
        }
        
        .content-list li:last-child {
            margin-bottom: 0;
        }
        
        .ordered-list {
            list-style-type: decimal;
            padding-left: 20px;
        }
        
        .ordered-list li {
            position: relative;
            padding-left: 0;
        }
        
        .ordered-list li::marker {
            color: #3498db;
            font-weight: 600;
        }
        
        .progress-indicator {
            background: #f3f4f6;
            border-radius: 10px;
            overflow: hidden;
            height: 8px;
            margin-top: 10px;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            transition: width 0.5s ease;
        }
        
        /* ÈóÆÈ¢òÂç°ÁâáÁæéÂåñÊ†∑Âºè */
        .issue-card {
            margin-bottom: 16px;
            border-left: 4px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .issue-card.severity-critical {
            border-left-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2 0%, #ffffff 100%);
        }
        
        .issue-card.severity-high {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb 0%, #ffffff 100%);
        }
        
        .issue-card.severity-medium {
            border-left-color: #06b6d4;
            background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 100%);
        }
        
        .issue-card.severity-low {
            border-left-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
        }
        
        .issue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0;
        }
        
        .issue-type-section {
            display: flex;
            align-items: center;
        }
        
        .issue-actions {
            display: flex;
            align-items: center;
        }
        
        .issue-content {
            padding: 0;
        }
        
        .issue-description,
        .issue-suggestion,
        .issue-hint {
            margin-bottom: 20px;
        }
        
        .issue-description:last-child,
        .issue-suggestion:last-child,
        .issue-hint:last-child {
            margin-bottom: 0;
        }
        
        .content-title {
            font-size: 14px;
            font-weight: 600;
            margin: 0 0 8px 0;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .content-text {
            margin: 0;
            line-height: 1.6;
            color: #6b7280;
            background: #f9fafb;
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .issue-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .scenario-title {
            font-weight: bold;
            color: #303133;
            flex: 1;
        }

        .scenario-content {
            padding: 5px 0;
        }

        .scenario-section {
            margin-bottom: 15px;
        }

        .scenario-section h5 {
            margin: 0 0 8px 0;
            color: #409eff;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .scenario-section p {
            margin: 0;
            color: #606266;
            line-height: 1.5;
        }
        
        /* Â§öË°åÊñáÊú¨ÊòæÁ§∫Ê†∑Âºè */
        .content-text-multiline {
            white-space: pre-line;
            word-wrap: break-word;
            line-height: 1.6;
        }

        .steps-content {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid #67c23a;
            white-space: pre-line;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.6;
        }

        .scenario-meta {
            margin-top: 10px;
            text-align: right;
        }

        /* ÂéÜÂè≤‰ªªÂä°ÊäΩÂ±âÊ†∑Âºè */
        .history-drawer .el-drawer__body {
            padding: 20px;
        }
        
        .history-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e4e7ed;
        }
        
        .history-content {
            height: calc(100vh - 140px);
        }
        
        .history-task-card {
            margin-bottom: 12px;
        }
        
        .task-card-enhanced {
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid #e4e7ed;
        }
        
        .task-card-enhanced:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: #409eff;
        }
        
        .task-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .task-id-link {
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .task-id-link:hover {
            transform: translateY(-1px);
            text-shadow: 0 2px 4px rgba(64, 158, 255, 0.3);
        }
        
        .task-info {
            flex: 1;
            margin-right: 16px;
        }
        
        .task-id-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .task-id {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            color: #409eff;
            font-weight: 600;
            margin-right: 12px;
            background: #f0f9ff;
            padding: 4px 8px;
            border-radius: 6px;
            border: 1px solid #e1f5fe;
        }
        
        .status-tag {
            margin-left: auto;
        }
        
        .task-details {
            margin-bottom: 12px;
        }
        
        .detail-item {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        .task-time {
            margin-bottom: 8px;
            width: 100%;
        }
        
        .time-item {
            display: flex;
            align-items: center;
            margin-bottom: 4px;
            font-size: 0.85rem;
            color: #606266;
        }
        
        .detail-item .label,
        .time-item .label {
            font-weight: 500;
            margin-right: 6px;
            color: #606266;
            min-width: 40px;
        }
        
        .detail-item .value,
        .time-item .value {
            color: #303133;
            font-family: 'Monaco', 'Consolas', monospace;
        }
        
        .task-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .task-actions .el-button {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
        }
        
        .task-actions .el-button * {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
        }
        
        .task-actions .el-button .el-icon {
            margin-right: 4px !important;
        }
        
        .empty-state {
            padding: 40px 20px;
            text-align: center;
        }
        
        /* ‰ªªÂä°‰ø°ÊÅØÂç°ÁâáÊ†∑Âºè */
        .task-info-card {
            border-radius: 12px;
            border: 1px solid #e4e7ed;
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
        }
        
        .task-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .task-info-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #303133;
            display: flex;
            align-items: center;
        }
        
        .task-info-content {
            padding-top: 8px;
        }
        
        .info-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }
        
        .info-label {
            font-weight: 500;
            margin-right: 8px;
            color: #606266;
            min-width: 80px;
        }
        
        .info-value {
            color: #303133;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.85rem;
            background: #f5f7fa;
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px solid #e4e7ed;
        }
        
        /* ‰ªªÂä°ËøõÂ∫¶Êù°Ê†∑Âºè */
        .task-progress {
            margin-top: 20px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .progress-header {
            margin-bottom: 12px;
        }
        
        .progress-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #495057;
            display: flex;
            align-items: center;
        }
        
        .progress-bar {
            margin-top: 8px;
        }
        
        .progress-text-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
            padding: 10px 14px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            border: 1px solid #dee2e6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .progress-text {
            font-size: 15px;
            font-weight: 600;
            color: #495057;
            flex: 1;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
                        .progress-percentage {
                    font-size: 18px;
                    font-weight: bold;
                    color: #409eff;
                    min-width: 60px;
                    text-align: right;
                    padding: 4px 8px;
                    background: rgba(64, 158, 255, 0.1);
                    border-radius: 4px;
                }
                
                .abort-button-container {
                    text-align: center;
                    margin-top: 16px;
                    padding-top: 16px;
                    border-top: 1px solid #f0f0f0;
                }
        
        /* Á≥ªÁªüÈÄâÊã©ÂÆπÂô®Ê†∑Âºè */
        .system-selection-container {
            display: flex;
            gap: 8px;
            align-items: flex-start;
            width: 100%;
        }
        
        .system-selector-input {
            flex: 1;
            border-radius: var(--card-radius-sm);
        }
        
        .system-selector-input .el-input__wrapper {
            border-radius: var(--card-radius-sm);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: var(--transition-normal);
            border: 1px solid var(--color-gray-300);
        }
        
        .system-selector-input .el-input__wrapper:hover {
            box-shadow: var(--hover-shadow);
            border-color: var(--el-color-primary);
        }
        
        .system-selector-input .el-input__wrapper.is-focus {
            border-color: var(--el-color-primary);
            box-shadow: var(--focus-shadow);
        }
        
        .refresh-button {
            flex-shrink: 0;
            height: 32px;
            border-radius: var(--card-radius-sm);
            border: 1px solid var(--color-gray-300);
            background: var(--color-gray-50);
            color: var(--color-gray-700);
            transition: var(--transition-fast);
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
            font-weight: 500;
        }
        
        .refresh-button * {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
        }
        
        .refresh-button .el-icon {
            margin-right: var(--spacing-xs) !important;
        }
        
        .refresh-button:hover {
            background: var(--color-gray-100);
            border-color: var(--color-gray-400);
            transform: translateY(-1px);
            box-shadow: var(--soft-shadow);
            color: var(--color-gray-800);
        }
        
        .refresh-button:active {
            transform: translateY(0);
        }
        
        /* Á°Æ‰øùË°®ÂçïÈ°πÂÆΩÂ∫¶‰∏ÄËá¥ */
        .selection-area .el-form-item__content {
            width: 100%;
        }
        
        /* ‰ºòÂåñÁ≥ªÁªüÈÄâÈ°πÊ†∑Âºè */
        .system-option-simple {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            padding-right: 48px; /* ‰∏∫Âè≥‰æßÈÄâ‰∏≠ÊåáÁ§∫Âô®ÁïôÂá∫Á©∫Èó¥ */
            border-radius: 8px;
            transition: all 0.2s ease;
            border: 1px solid transparent;
            margin: 3px 0;
            position: relative;
            overflow: hidden;
            background: #ffffff;
        }
        
        .system-option-simple::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: #3b82f6;
            transform: scaleY(0);
            transition: all 0.2s ease;
        }
        
        .system-option-simple:hover {
            background: #f3f4f6;
            border-color: #d1d5db;
            transform: translateX(1px);
        }
        
        .system-option-simple:hover::before {
            transform: scaleY(1);
        }
        
        /* ÊÇ¨ÂÅúÁä∂ÊÄÅ‰∏çÊòæÁ§∫ÈÄâ‰∏≠ÊåáÁ§∫Âô® */
        .system-option-simple:hover::after {
            display: none;
        }
        
        .system-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            flex: 1;
        }
        
        .system-name {
            font-weight: 700;
            color: var(--color-gray-800);
            font-size: 1rem;
            letter-spacing: -0.025em;
        }
        
        .project-count {
            color: var(--color-gray-600);
            font-size: 0.8rem;
            background: linear-gradient(135deg, var(--color-gray-50) 0%, var(--color-gray-100) 100%);
            padding: 3px var(--spacing-sm);
            border-radius: var(--card-radius-sm);
            font-weight: 500;
            border: 1px solid var(--color-gray-300);
            transition: var(--transition-fast);
        }
        
        .project-count:hover {
            background: linear-gradient(135deg, var(--color-gray-100) 0%, var(--color-gray-200) 100%);
            transform: scale(1.05);
        }
        
        .project-name {
            color: #3b82f6;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 8px;
            padding: 4px 8px;
            background: #f3f4f6;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            transition: all 0.2s ease;
        }
        
        .project-name:hover {
            background: #e5e7eb;
            border-color: #3b82f6;
        }
        
        .system-tags {
            flex-shrink: 0;
            display: flex;
            gap: var(--spacing-xs);
            margin-right: var(--spacing-sm); /* ‰∏éÈÄâ‰∏≠ÊåáÁ§∫Âô®‰øùÊåÅË∑ùÁ¶ª */
        }
        
        /* Ëá™ÂÆö‰πâÊ†áÁ≠æÊ†∑Âºè */
        .custom-tag {
            border-radius: 6px !important;
            font-weight: 600 !important;
            font-size: 0.75rem !important;
            padding: var(--spacing-xs) var(--spacing-sm) !important;
            border: none !important;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
            transition: var(--transition-fast) !important;
        }
        
        .custom-tag:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15) !important;
        }
        
        .dynamic-tag {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%) !important;
            color: #166534 !important;
        }
        
        .static-tag {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
            color: #475569 !important;
        }
        
        .project-tag {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%) !important;
            color: #92400e !important;
        }
        
        /* ‰ºòÂåñ‰∏ãÊãâÊ°ÜÂºπÂá∫Â±ÇÊ†∑Âºè */
        .system-dropdown-popper {
            min-width: 450px !important;
            max-width: 650px !important;
            border-radius: 12px !important;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
            border: 1px solid #e5e7eb !important;
            background: #ffffff !important;
            padding: 8px 0 !important;
        }
        
        /* Ëá™ÂÆö‰πâÊªöÂä®Êù°Ê†∑Âºè */
        .system-dropdown-popper .el-scrollbar__wrap {
            scrollbar-width: thin;
            scrollbar-color: var(--color-gray-300) var(--color-gray-100);
        }
        
        .system-dropdown-popper .el-scrollbar__wrap::-webkit-scrollbar {
            width: 6px;
        }
        
        .system-dropdown-popper .el-scrollbar__wrap::-webkit-scrollbar-track {
            background: var(--color-gray-100);
            border-radius: 3px;
        }
        
        .system-dropdown-popper .el-scrollbar__wrap::-webkit-scrollbar-thumb {
            background: var(--color-gray-300);
            border-radius: 3px;
        }
        
        .system-dropdown-popper .el-scrollbar__wrap::-webkit-scrollbar-thumb:hover {
            background: var(--color-gray-400);
        }
        
        .system-dropdown-popper .el-select-dropdown__item {
            padding: 0 !important;
            height: auto !important;
            line-height: normal !important;
            border-radius: 8px !important;
            margin: 2px 12px !important;
            transition: all 0.2s ease !important;
        }
        
        .system-dropdown-popper .el-select-dropdown__item:hover {
            transform: translateX(1px) !important;
        }
        
        .system-dropdown-popper .el-select-dropdown__item.is-hovering {
            background: transparent !important;
        }
        
        .system-dropdown-popper .el-select-dropdown__item.is-selected {
            background: transparent !important;
        }
        
        .system-dropdown-popper .el-select-dropdown__item.is-selected .system-option-simple {
            background: #3b82f6 !important;
            border-color: #3b82f6 !important;
            transform: translateX(1px) !important;
        }
        
        .system-dropdown-popper .el-select-dropdown__item.is-selected .system-option-simple::before {
            transform: scaleY(1) !important;
        }
        
        /* ÈöêËóèÈªòËÆ§ÁöÑÈÄâ‰∏≠ÂØπÂãæÔºåÈÅøÂÖç‰∏éÊñáÂ≠óÈáçÂè† */
        .system-dropdown-popper .el-select-dropdown__item.is-selected::after {
            display: none !important;
        }
        
        /* ‰∏∫ÈÄâ‰∏≠Áä∂ÊÄÅÊ∑ªÂä†Âè≥‰æßÈÄâ‰∏≠ÊåáÁ§∫Âô® */
        .system-dropdown-popper .el-select-dropdown__item.is-selected .system-option-simple::after {
            content: '‚úì';
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-weight: bold;
            font-size: 16px;
            background: #3b82f6;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        

        

        
        /* Á≥ªÁªüÈÄâÊã©Âô®ËæìÂÖ•Ê°ÜÊ†∑Âºè */
        .system-selector-input {
            width: 100%;
        }
        
        .system-selector-input .el-select__tags {
            padding: 4px 8px;
        }
        
        .system-selector-input .el-select__tags .el-tag {
            margin: 2px 4px;
            border-radius: 6px;
            background: #3b82f6;
            border: 1px solid #3b82f6;
            color: white;
            font-weight: 500;
        }
        
        .system-selector-input .el-select__tags .el-tag .el-tag__close {
            color: white;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            margin-left: 4px;
            transition: var(--transition-fast);
        }
        
        .system-selector-input .el-select__tags .el-tag .el-tag__close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        /* Â±ÇÁ∫ßÂåñ‰∏ãÊãâÊ°ÜÊ†∑Âºè */
        .system-dropdown-popper .el-select-group__wrap {
            padding: 0 !important;
        }
        
        .system-dropdown-popper .el-select-group__title {
            padding: 12px 16px !important;
            font-size: 13px !important;
            font-weight: 600 !important;
            color: #374151 !important;
            background: #f9fafb !important;
            border-bottom: 1px solid #e5e7eb !important;
            margin: 0 !important;
            position: relative;
            overflow: hidden;
        }
        
        .system-dropdown-popper .el-select-group__title::after {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: #3b82f6;
        }
        
        .system-dropdown-popper .el-select-group__title::before {
            content: 'üìÅ';
            margin-right: var(--spacing-sm);
            font-size: 16px;
        }
        
        .project-subgroup .el-select-group__title::before {
            content: 'üìÇ';
            margin-right: var(--spacing-sm);
            font-size: 16px;
        }
        
        .system-dropdown-popper .el-select-group__wrap .el-select-dropdown__item {
            margin: 3px 10px !important;
        }
        
        .system-dropdown-popper .el-select-group__wrap .el-select-dropdown__item:first-child {
            margin-top: 6px !important;
        }
        
        .system-dropdown-popper .el-select-group__wrap .el-select-dropdown__item:last-child {
            margin-bottom: 6px !important;
        }
        
        /* È°πÁõÆÁ∫ßÈÄâÈ°πÊ†∑Âºè */
        .project-level-option {
            border-left: 3px solid var(--color-gray-300) !important;
            background: linear-gradient(135deg, var(--color-gray-50) 0%, var(--color-gray-100) 100%) !important;
            transition: var(--transition-normal) !important;
        }
        
        .project-level-option:hover {
            background: linear-gradient(135deg, var(--color-gray-100) 0%, var(--color-gray-200) 100%) !important;
            border-left-color: var(--el-color-primary) !important;
            transform: translateX(2px) !important;
            box-shadow: var(--soft-shadow) !important;
        }
        
        /* Á≥ªÁªüÁ∫ßÈÄâÈ°πÊ†∑Âºè */
        .system-level-option {
            border-left: 3px solid var(--el-color-primary) !important;
            background: linear-gradient(135deg, var(--color-gray-50) 0%, var(--color-gray-100) 100%) !important;
            transition: var(--transition-normal) !important;
        }
        
        .system-level-option:hover {
            background: linear-gradient(135deg, var(--color-gray-100) 0%, var(--color-gray-200) 100%) !important;
            transform: translateX(2px) !important;
            box-shadow: var(--soft-shadow) !important;
        }
        
        /* È°πÁõÆÁ∫ßÈÄâÈ°πÊ†∑Âºè */
        .project-level-option {
            border-left: 3px solid #d1d5db !important;
            background: #ffffff !important;
        }
        
        .project-level-option:hover {
            background: #f3f4f6 !important;
            border-left-color: #3b82f6 !important;
        }
        
        /* Á≥ªÁªüÊ†áÁ≠æÊ†∑Âºè */
        .system-tag {
            background: #3b82f6 !important;
            border-color: #3b82f6 !important;
            color: white !important;
            transition: all 0.2s ease !important;
        }
        
        .system-tag:hover {
            background: #2563eb !important;
            transform: translateY(-1px) !important;
        }

        .stats-bar {
            height: 6px;
            background: #f5f7fa;
            border-radius: 3px;
            overflow: hidden;
            margin: 8px 0 12px;
        }

        .stats-bar-inner {
            height: 100%;
            display: flex;
        }

        .stats-bar-additions {
            background-color: #67c23a;
        }

        .stats-bar-deletions {
            background-color: #f56c6c;
        }

        .stats-bar-changes {
            background-color: #e6a23c;
        }

        .stats-details {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #909399;
        }
        
        /* ÂìçÂ∫îÂºèÂ∏ÉÂ±Ä‰ºòÂåñ */
        @media (max-width: 768px) {
            body {
                padding: var(--spacing-sm);
            }
            
            .container {
                padding: var(--spacing-md);
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .selection-area {
                padding: var(--spacing-md);
            }
            
            .scenario-card .el-col {
                width: 100% !important;
            }
            
            .history-drawer {
                width: 90% !important;
            }
            
            .task-card-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .task-actions {
                flex-direction: row;
                margin-top: var(--spacing-sm);
            }
            
            .system-selection-container {
                flex-direction: column;
                gap: var(--spacing-sm);
            }
            
            .system-selector-input {
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 20px;
            }
            
            .container {
                padding: var(--spacing-sm);
            }
            
            .selection-area {
                padding: var(--spacing-sm);
            }
        }

        /* ÈÄöÁü•ÈÖçÁΩÆÂØπËØùÊ°ÜÊ†∑Âºè */
        .notification-section {
            margin-bottom: 16px;
        }

        .notification-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
        }

        .notification-header span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notification-switch {
            margin-left: auto;
        }

        .config-label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: #606266;
        }

        .recipients-input,
        .mentions-input {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .recipients-list,
        .mentions-list {
            margin-top: 10px;
            min-height: 40px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 6px;
            border: 1px dashed #d0d7de;
        }

        .no-recipients,
        .no-mentions {
            text-align: center;
            color: #909399;
            font-size: 14px;
        }

        .email-recipients,
        .wechat-mentions {
            margin-top: 15px;
        }

        .dialog-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* ËôöÊãüÊªöÂä®Ê†∑Âºè */
        .virtual-scroll-container {
            position: relative;
            border-radius: var(--card-radius-sm);
            border: 1px solid var(--color-gray-200);
            background: #fff;
        }
        
        .virtual-placeholder {
            position: relative;
            width: 100%;
        }
        
        .virtual-items {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
        }
        
        .virtual-item {
            padding: 8px 16px;
            box-sizing: border-box;
            border-bottom: 1px solid var(--color-gray-100);
        }
        
        .virtual-item:last-child {
            border-bottom: none;
        }
        
        .virtual-scroll-info {
            position: sticky;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            padding: 8px 16px;
            border-top: 1px solid var(--color-gray-200);
            text-align: center;
            font-size: 12px;
            color: var(--color-gray-500);
        }
        
        /* ‰ºòÂåñËôöÊãüÊªöÂä®‰∏≠ÁöÑ‰ªªÂä°Âç°Áâá */
        .virtual-item .task-card-enhanced {
            margin-bottom: 0;
            height: calc(100% - 16px);
            display: flex;
            flex-direction: column;
        }
        
        .virtual-item .task-card-enhanced .el-card__body {
            flex: 1;
            padding: 16px;
            overflow: hidden;
        }
        
        /* ËôöÊãüÊªöÂä®ÊªöÂä®Êù°Ê†∑Âºè */
        .virtual-scroll-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .virtual-scroll-container::-webkit-scrollbar-track {
            background: var(--color-gray-100);
            border-radius: 4px;
        }
        
        .virtual-scroll-container::-webkit-scrollbar-thumb {
            background: var(--color-gray-300);
            border-radius: 4px;
            transition: background var(--transition-fast);
        }
        
        .virtual-scroll-container::-webkit-scrollbar-thumb:hover {
            background: var(--color-gray-400);
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 92vh;
        }

        main {
            flex: 1;
        }

        .footer {
            position: relative;
            width: 100%;
            height: 30px;
            font-size: 80%;
            padding: 5px 0;
            margin-top: auto;
            bottom: 0;
            text-align: center;
        }
        
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <div class="header">
                <h1 v-if="!reportId">üöÄ GitÂ¢ûÈáè‰ª£Á†ÅÊô∫ËÉΩÂÆ°Êü•‰∏éÊµãËØïÁî®‰æãÁîüÊàêÁ≥ªÁªü</h1>
                <h1 v-else>üöÄ GitÂ¢ûÈáè‰ª£Á†ÅÊô∫ËÉΩÂÆ°Êü•Êä•Âëä</h1>
                <p>Êô∫ËÉΩÂàÜÊûê‰ª£Á†ÅÂèòÊõ¥ÔºåËá™Âä®ÁîüÊàêÊµãËØïÁî®‰æã</p>
                <div v-if="!reportId" style="display: flex; gap: 10px; justify-content: center;">
                    <el-button class="history-entry" type="success" size="small" @click="openRepoDialog" icon="Plus" style="margin-top: -10px;">
                        Ê∑ªÂä†‰ªìÂ∫ì
                    </el-button>
                    <el-button class="history-entry" type="info" size="small" @click="openNotificationConfig" icon="Message" style="margin-top: 20px;">
                        ÈÄöÁü•ÈÖçÁΩÆ
                    </el-button>
                    <el-button class="history-entry" type="primary" size="small" @click="openHistory" icon="Clock" style="margin-top: 50px;">
                        ÂéÜÂè≤ÁªìÊûú
                    </el-button>
                </div>
            </div>
            
            <div  v-if="!reportId" class="selection-area">
                <el-form :model="form" label-width="120px">
                    <el-form-item label="ÈÄâÊã©Á≥ªÁªü/È°πÁõÆÔºö">
                      <div class="system-selection-container">
                        <!-- Áî® el-tree-select ÂÆûÁé∞Â§öÁ∫ßÈ°πÁõÆ -->
                        <el-tree-select
                          v-model="selectedSystems"
                          :data="treeData"
                          :render-after-expand="false"
                          :show-checkbox="true"
                          :check-strictly="false"
                          :check-on-click-node="true"
                          :expand-on-click-node="false"
                          :multiple="true"
                          :collapse-tags="true"
                          :collapse-tags-tooltip="true"
                          :max-collapse-tags="2"
                          placeholder="ËØ∑ÈÄâÊã©‰∏Ä‰∏™ÊàñÂ§ö‰∏™Á≥ªÁªüÊàñÈ°πÁõÆ"
                          clearable
                          filterable
                          style="flex:1"
                        >
                        </el-tree-select>
                        <el-button
                          type="default"
                          @click="refreshSystems"
                          :loading="systemsLoading"
                          icon="Refresh"
                          title="Âà∑Êñ∞Á≥ªÁªüÂàóË°®"
                          class="refresh-button"
                        >
                          Âà∑Êñ∞
                        </el-button>
                      </div>
                      <!-- Êó†Êï∞ÊçÆÊèêÁ§∫ -->
                      <div v-if="!systemsLoading && !systems.length" class="systems-status-info">
                        <el-alert
                          type="warning"
                          title="ÊöÇÊó†ÂèØÁî®Á≥ªÁªü,ËØ∑Ê£ÄÊü•ÈÖçÁΩÆÊñá‰ª∂ÊàñÁΩëÁªúËøûÊé•ÔºåÁÑ∂ÂêéÁÇπÂáªÂà∑Êñ∞ÊåâÈíÆÈáçËØï"
                          :description="rateLimitDescription"
                          size="small"
                          :auto-close="5000"
                          show-icon
                          :closable="false"
                          style="margin-top:5px;width:100%"
                        >
                        </el-alert>
                      </div>
                    </el-form-item>
                    
                    <el-form-item label="ÂàÜÊîØÂêçÁß∞Ôºö">
                        <el-select v-if="branchesOptions.length > 1 && switchBranch" v-model="branchName" filterable placeholder="ËØ∑ÈÄâÊã©ÂàÜÊîØÂêçÁß∞" style="flex:1;margin-right:32px">
                            <el-option
                              v-for="item in branchesOptions"
                              :key="item.value"
                              :label="item.label"
                              :value="item.value" >
                            </el-option>
                        </el-select>
                        <el-input v-else v-model="branchName" placeholder="ËØ∑ËæìÂÖ•ÂàÜÊîØÂêçÁß∞ÔºåÂ¶ÇÔºömain„ÄÅdevelop„ÄÅfeature/xxx" style="flex:1;margin-right:32px"></el-input>
                        <el-switch
                            v-model="switchBranch"
                            active-color="#13ce66"
                            inactive-color="#ff4949"
                            style="margin-right: 20px">
                        </el-switch>
                    </el-form-item>
                </el-form>
            </div>
            
            <div  v-if="!reportId" class="operation-area">
                <el-button 
                    type="primary" 
                    size="large" 
                    @click="startReview"
                    :loading="loading"
                    :disabled="!selectedSystems.length || !branchName">
                    ÂºÄÂßãÂÆ°Êü•
                </el-button>
            </div>
            
            <div class="result-area" v-if="currentTask">
                <!-- ‰ªªÂä°‰ø°ÊÅØÂç°Áâá -->
                <el-card class="task-info-card" shadow="hover" style="margin-bottom: 20px;">
                    <template #header>
                        <div class="task-info-header">
                            <span class="task-info-title">
                                <el-icon style="margin-right: 8px; color: #409eff;"><Document /></el-icon>
                                ÂÆ°Êü•‰ªªÂä°‰ø°ÊÅØ
                            </span>
                            <el-tag :type="getStatusTagType(currentTask.status)" size="small">
                                {{ "{{ currentTask.status }}" }}
                            </el-tag>
                        </div>
                    </template>
                    
                    <div class="task-info-content">
                        <el-row :gutter="24">
                            <el-col :span="12">
                                <div class="info-item">
                                    <el-icon style="margin-right: 6px; color: #909399;"><Key /></el-icon>
                                    <span class="info-label">‰ªªÂä°IDÔºö</span>
                                    <span class="info-value">{{ "{{ currentTask.id || currentTask.task_id }}" }}</span>
                                </div>
                                <div class="info-item">
                                    <el-icon style="margin-right: 6px; color: #67c23a;"><Monitor /></el-icon>
                                    <span class="info-label">ÈÄâÊã©Á≥ªÁªüÔºö</span>
                                    <span class="info-value">
                                        <span v-if="currentTask.system_names">{{ "{{ currentTask.system_names.join(', ') }}" }}</span>
                                        <span v-else>{{ "{{ currentTask.system_name }}" }}</span>
                                    </span>
                                </div>
                                <div class="info-item">
                                    <el-icon style="margin-right: 6px; color: #e6a23c;"><Guide /></el-icon>
                                    <span class="info-label">ÂàÜÊîØÔºö</span>
                                    <span class="info-value">{{ "{{ currentTask.branch_name }}" }}</span>
                                </div>
                            </el-col>
                            <el-col :span="12">
                                <div class="info-item">
                                    <el-icon style="margin-right: 6px; color: #909399;"><Clock /></el-icon>
                                    <span class="info-label">ÂàõÂª∫Êó∂Èó¥Ôºö</span>
                                    <span class="info-value">{{ "{{ formatDateTime(currentTask.created_at) }}" }}</span>
                                </div>
                                <div class="info-item">
                                    <el-icon style="margin-right: 2px; color: #909399;"><Edit /></el-icon>
                                    <span class="info-label">Êõ¥Êñ∞Êó∂Èó¥Ôºö</span>
                                    <span class="info-value">{{ "{{ formatDateTime(currentTask.updated_at) }}" }}</span>
                                </div>
                                <div class="info-item" v-if="currentTask.multi_system">
                                    <el-icon style="margin-right: 6px; color: #f56c6c;"><Grid /></el-icon>
                                    <span class="info-label">Á≥ªÁªüÊï∞ÈáèÔºö</span>
                                    <span class="info-value">{{ "{{ currentTask.total_systems || (currentTask.system_names && currentTask.system_names.length) || 1 }}" }} ‰∏™</span>
                                </div>
                            </el-col>
                        </el-row>
                        
                        <!-- ‰ªªÂä°ËøõÂ∫¶Êù° -->
                        <div v-if="currentTask.status === 'processing' || currentTask.status === 'pending'" class="task-progress">
                            <div class="progress-header">
                                <span class="progress-title">
                                    <el-icon class="is-loading" style="margin-right: 6px;"><Loading /></el-icon>
                                    ‰ªªÂä°ÊâßË°åËøõÂ∫¶
                                </span>
                            </div>
                            <el-progress 
                                :percentage="getTaskProgress(currentTask)" 
                                :status="currentTask.status === 'processing' ? 'active' : (currentTask.status === 'completed' ? 'success' : (currentTask.status === 'aborted' ? 'warning' : 'exception'))"
                                :stroke-width="12"
                                striped
                                striped-flow
                                :show-text="false"
                                class="progress-bar">
                            </el-progress>
                            <div class="progress-text-container">
                                <span class="progress-text">{{ "{{ getTaskProgressText(currentTask) }}" }}</span>
                                <span class="progress-percentage">{{ "{{ getTaskProgress(currentTask) }}" }}%</span>
                            </div>
                            
                            <!-- ‰∏≠Ê≠¢ÊåâÈíÆ - ‰ªÖÂú®‰ªªÂä°ÊâßË°å‰∏≠ÊòæÁ§∫ -->
                            <div v-if="currentTask && (currentTask.status === 'processing' || currentTask.status === 'pending')" class="abort-button-container">
                                <el-button 
                                    type="danger" 
                                    size="small" 
                                    icon="Close"
                                    :loading="abortLoading"
                                    @click="confirmAbortTask"
                                    plain>
                                    ‰∏≠Ê≠¢‰ªªÂä°
                                </el-button>

                            </div>
                        </div>
                    </div>
                </el-card>
                
                <div v-if="currentTask.status === 'failed'" style="margin-bottom:12px;">
                    <el-alert type="error" show-icon :title="(currentTask.result && currentTask.result.error) || currentTask.error || '‰ªªÂä°Â§±Ë¥•'"></el-alert>
                </div>
                
                <!-- ÁªüËÆ°‰ø°ÊÅØÈù¢Êùø -->
                <div v-if="currentTask.status === 'completed' && currentTask.result && currentTask.result.statistics" class="statistics-overview">
                    <!-- ÁßªÈô§Â§ßÊ†áÈ¢òÂíåË¥®ÈáèÂæóÂàÜÔºå‰ΩøÁªüËÆ°Êõ¥Á¥ßÂáë -->
                    
                    <!-- ÁªüËÆ°Âç°Áâá -->
                    <el-row :gutter="20" style="margin-bottom: 20px;">
                        <el-col :span="6">
                            <div class="stat-card danger">
                                <div class="stat-number">{{ "{{ (currentTask.result && currentTask.result.statistics && currentTask.result.statistics.summary && currentTask.result.statistics.summary.total_issues_found) || 0 }}" }}</div>
                                <div class="stat-label">ÂèëÁé∞ÈóÆÈ¢ò</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="stat-card success">
                                <div class="stat-number">{{ "{{ (currentTask.result && currentTask.result.statistics && currentTask.result.statistics.summary && currentTask.result.statistics.summary.total_unit_tests) || 0 }}" }}</div>
                                <div class="stat-label">ÂçïÂÖÉÊµãËØï</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="stat-card info">
                                <div class="stat-number">{{ "{{ (currentTask.result && currentTask.result.statistics && currentTask.result.statistics.summary && currentTask.result.statistics.summary.total_scenario_tests) || 0 }}" }}</div>
                                <div class="stat-label">Âú∫ÊôØÊµãËØï</div>
                            </div>
                        </el-col>
                        <el-col :span="6">
                            <div class="stat-card warning">
                                <div class="stat-number">{{ "{{ (currentTask.result && currentTask.result.statistics && currentTask.result.statistics.summary && currentTask.result.statistics.summary.total_files_reviewed) || 0 }}" }}</div>
                                <div class="stat-label">ÂÆ°Êü•Êñá‰ª∂</div>
                            </div>
                        </el-col>
                    </el-row>
                    
                    <!-- ÂõæË°®Âå∫Âüü -->
                    <el-row :gutter="20">
                        <el-col :span="12">
                            <div class="chart-container">
                                <div class="chart-title">ÈóÆÈ¢ò‰∏•ÈáçÁ®ãÂ∫¶ÂàÜÂ∏É</div>
                                <div class="chart-wrapper">
                                    <canvas :id="'severityChart-' + currentTask.id"></canvas>
                                </div>
                            </div>
                        </el-col>
                        <el-col :span="12">
                            <div class="chart-container">
                                <div class="chart-title">ÈóÆÈ¢òÁ±ªÂûãÂàÜÊûê</div>
                                <div class="chart-wrapper">
                                    <canvas :id="'categoryChart-' + currentTask.id"></canvas>
                                </div>
                            </div>
                        </el-col>
                    </el-row>
                    
                    <!-- ËØ≠Ë®ÄÂíåÊ®°Âùó‰ø°ÊÅØ -->
                    <el-row :gutter="20" style="margin-top: 20px;">
                        <el-col :span="12">
                            <div class="chart-container">
                                <div class="chart-title">Ê£ÄÊµãÂà∞ÁöÑÁºñÁ®ãËØ≠Ë®Ä</div>
                                <div v-if="currentTask.result.statistics && currentTask.result.statistics.review_statistics && currentTask.result.statistics.review_statistics.languages_detected && currentTask.result.statistics.review_statistics.languages_detected.length">
                                    <span 
                                        v-for="language in currentTask.result.statistics.review_statistics.languages_detected" 
                                        :key="language" 
                                        class="language-tag">
                                        {{ "{{ language }}" }}
                                    </span>
                                </div>
                                <div v-else style="color: #909399; text-align: center; padding: 20px;">ÊöÇÊó†ËØ≠Ë®Ä‰ø°ÊÅØ</div>
                            </div>
                        </el-col>
                        <el-col :span="12">
                            <div class="chart-container">
                                <div class="chart-title">ÊµãËØïË¶ÜÁõñÊ®°Âùó</div>
                                <div v-if="currentTask.result.statistics && currentTask.result.statistics.scenario_test_statistics && currentTask.result.statistics.scenario_test_statistics.modules_covered && currentTask.result.statistics.scenario_test_statistics.modules_covered.length">
                                    <span 
                                        v-for="module in currentTask.result.statistics.scenario_test_statistics.modules_covered" 
                                        :key="module" 
                                        class="language-tag">
                                        {{ "{{ module }}" }}
                                    </span>
                                </div>
                                <div v-else style="color: #909399; text-align: center; padding: 20px;">ÊöÇÊó†Ê®°Âùó‰ø°ÊÅØ</div>
                            </div>
                        </el-col>
                    </el-row>
                </div>
                
                <el-tabs v-model="activeTab">
                    <!-- ‰ª£Á†ÅÂÆ°Êü•ÁªìÊûú -->
                    <el-tab-pane label="‰ª£Á†ÅÂÆ°Êü•ÁªìÊûú" name="review">
                        <div v-if="currentTask.status === 'completed' && currentTask.result && currentTask.result.report">
                            <div v-for="(report, index) in currentTask.result.report" :key="index">
                                <el-card class="unit-test-card">
                                    <div slot="header" style="margin-bottom: 10px;">
                                        <el-row align="middle" justify="space-between" style="flex-wrap: nowrap;">
                                            <el-col :span="12" style="display: flex; white-space: nowrap;overflow: hidden;">
                                                <span v-text="`${report.project_name} - `" style="flex-shrink: 0;"></span>
                                                <el-tooltip
                                                    :content="report.filename"
                                                    placement="top"
                                                    effect="dark"
                                                    :disabled="isTooltipDisabled"
                                                >
                                                    <span v-text="report.filename" @mouseenter="isTooltipDisabled = $event.target.scrollWidth < $event.target.clientWidth" style="flex: 1 1 0%;direction: rtl;unicode-bidi: plaintext;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"></span>
                                                </el-tooltip>
                                            </el-col>
                                            <el-col  v-if="report.filestatus" :span="12" style="text-align: right; white-space: nowrap;">
                                                <el-tag size="small" v-if="report.filestatus" :type="report.filestatus.status === 'removed' ? 'danger' : (report.filestatus.status === 'modified' ? 'warning' : 'success')" effect="Light" style="margin-left: 8px;" v-html="formatTestDescription(report.filestatus.status || '')"></el-tag>
                                                <div class="stats-bar">
                                                    <div class="stats-bar-inner">
                                                        <div class="stats-bar-additions" :style="{ width: getPercentage(report.filestatus.additions,report.filestatus) + '%' }"></div>
                                                        <div class="stats-bar-changes" :style="{ width: getPercentage(report.filestatus.changes,report.filestatus) + '%' }"></div>
                                                        <div class="stats-bar-deletions" :style="{ width: getPercentage(report.filestatus.deletions,report.filestatus) + '%' }"></div>
                                                    </div>
                                                </div>
                                                <div class="stats-details">
                                                    <span v-if="report.filestatus.additions>0" v-text="`Êñ∞Â¢û: ` + `${report.filestatus.additions}` + ` Ë°å`"></span>
                                                    <span v-if="report.filestatus.changes>0" v-text="`ÂèòÊõ¥: ` + `${report.filestatus.changes}` + ` Ë°å`"></span>
                                                    <span v-if="report.filestatus.deletions>0" v-text="`Âà†Èô§: ` + `${report.filestatus.deletions}` + ` Ë°å`"></span>
                                                </div>
                                            </el-col>
                                        </el-row>
                                    </div>
                                    <el-divider style="margin-top: 10px; margin-bottom: 10px;"></el-divider>
                                    <!-- Ëá™ÁÑ∂ËØ≠Ë®ÄÊèèËø∞ - ÈªòËÆ§ÊòæÁ§∫ -->
                                    <div v-if="report.business_logic" class="test-description">
                                        <div class="test-description-content" v-html="formatTestDescription(report.business_logic || '')"></div>
                                    </div>

                                    <!-- Êñá‰ª∂Diff‰ª£Á†ÅÂ±ïÁ§∫ÔºåÈªòËÆ§Êî∂Ëµ∑ -->
                                    <div v-if="report.diff_content" style="margin-bottom: 20px;">
                                        <el-card class="diff-card" shadow="never">
                                            <div slot="header" class="diff-header">
                                                <span style="font-weight: 600; color: #606266;">
                                                    <i class="el-icon-document-copy" v-if="report.summary" v-html="formatTestDescription(report.summary || '')"></i>
                                                    <i class="el-icon-document-copy" v-else>Êñá‰ª∂ÂèòÊõ¥ÂÜÖÂÆπ</i>
                                                </span>
                                            </div>
                                            <el-collapse style="border: none;">
                                                <el-collapse-item title="ÁÇπÂáªÂ±ïÂºÄÊü•ÁúãDiff‰ª£Á†Å" :name="`diff-${index}`">
                                                    <template #icon="{ isActive }">
                                                       <el-button
                                                            size="mini"
                                                            type="text"
                                                            icon="el-icon-copy-document"
                                                            @click.stop="copyCode(report.diff_content)">
                                                            Â§çÂà∂Diff
                                                        </el-button>
                                                    </template>

                                                    <div class="diff-block">
                                                        <pre><code v-text="report.diff_content"></code></pre>
                                                    </div>
                                                </el-collapse-item>
                                            </el-collapse>
                                        </el-card>
                                    </div>

                                    <el-collapse>
                                        <el-collapse-item
                                            :key="index"
                                            :name="index">

                                            <template #title="{ isActive }">
                                              <div style="white-space: nowrap;overflow-x: auto;padding-bottom: 4px;">
                                                <el-tag
                                                    v-for="(issue, issueIndex) in report.issues"
                                                    :color="getSeverityType(issue.severity)"
                                                    size="medium"
                                                    effect="dark"
                                                    style="margin-right: 8px;"
                                                    v-text="issue.type">
                                                </el-tag>
                                              </div>
                                            </template>

                                            <template #icon="{ isActive }">
                                              <span class="icon-ele" v-text="isActive ? 'Êî∂Ëµ∑' : 'Êü•ÁúãËØ¶ÁªÜ‰ø°ÊÅØ'"></span>
                                            </template>

                                            <div v-if="report.issues && report.issues.length > 0">
                                                <el-card
                                                    v-for="(issue, issueIndex) in report.issues"
                                                    :key="issueIndex"
                                                    class="issue-card"
                                                    :class="`severity-${issue.severity.toLowerCase()}`"
                                                    shadow="hover">
                                                    <div slot="header" class="issue-header">
                                                        <div class="issue-type-section">
                                                            <el-tag :color="getSeverityType(issue.severity)" size="medium" effect="dark">
                                                                <span style="margin-left: 5px;" v-text="issue.type"></span>
                                                            </el-tag>
                                                            <el-tag
                                                                :class="`issue-severity-${issue.severity.toLowerCase()}`"
                                                                size="small"
                                                                effect="plain"
                                                                style="margin-left: 8px;">
                                                                <span v-text="issue.severity"></span>
                                                            </el-tag>
                                                    </div>
                                                        <div class="issue-actions">
                                                            <el-button
                                                                size="mini"
                                                                type="text"
                                                                icon="el-icon-document-copy"
                                                                @click="copyCode(issue.description + '\\nÂª∫ËÆÆÔºö' + issue.suggestion)">
                                                                Â§çÂà∂
                                                            </el-button>
                                                        </div>
                                                    </div>
                                                    <div class="issue-content">
                                                        <div class="issue-description">
                                                            <h4 class="content-title">
                                                                <i class="el-icon-warning-outline" style="color: #f56c6c;"></i>
                                                                ÈóÆÈ¢òÊèèËø∞
                                                            </h4>
                                                            <p class="content-text">{{ "{{ issue.description }}" }}</p>
                                                        </div>
                                                        <div class="issue-suggestion">
                                                            <h4 class="content-title">
                                                                <i class="el-icon-magic-stick" style="color: #67c23a;"></i>
                                                                ‰øÆÊîπÂª∫ËÆÆ
                                                            </h4>
                                                            <p class="content-text">{{ "{{ issue.suggestion }}" }}</p>
                                                        </div>
                                                        <div v-if="issue.line_hint" class="issue-hint">
                                                            <h4 class="content-title">
                                                                <i class="el-icon-location-outline" style="color: #909399;"></i>
                                                                ‰ª£Á†Å‰ΩçÁΩÆ
                                                            </h4>
                                                            <p class="content-text">{{ "{{ issue.line_hint }}" }}</p>
                                                        </div>
                                                    </div>
                                                </el-card>
                                            </div>
                                            <div v-else>
                                                <el-empty description="Êú™ÂèëÁé∞ÊòéÊòæÈóÆÈ¢ò"></el-empty>
                                            </div>
                                        </el-collapse-item>
                                    </el-collapse>
                                </el-card>
                            </div>
                        </div>
                        <div v-else>
                            <el-empty description="ÊöÇÊó†ÂÆ°Êü•ÁªìÊûú"></el-empty>
                        </div>
                    </el-tab-pane>
                    
                    <!-- ÂçïÂÖÉÊµãËØïÁî®‰æã -->
                    <el-tab-pane label="ÂçïÂÖÉÊµãËØïÁî®‰æã" name="unit">
                        <div v-if="currentTask.status === 'completed' && currentTask.result && currentTask.result.unit_cases">
                            <div v-for="(unitCase, index) in currentTask.result.unit_cases" :key="index">
                                <el-card class="unit-test-card">
                                    <div slot="header" style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;text-align: left;">
                                        <span v-text="`${unitCase.project_name} - `"></span>
                                        <el-tooltip
                                            :content="unitCase.filename"
                                            placement="top"
                                            effect="dark"
                                            :disabled="isTooltipDisabled"
                                        >
                                            <span v-text="unitCase.filename" @mouseenter="isTooltipDisabled = $event.target.scrollWidth < $event.target.clientWidth" style="flex: 1 1 0%;direction: rtl;unicode-bidi: plaintext;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"></span>
                                        </el-tooltip>
                                    </div>
                                    
                                    <!-- Ëá™ÁÑ∂ËØ≠Ë®ÄÊèèËø∞ - ÈªòËÆ§ÊòæÁ§∫ -->
                                    <div class="test-description">
                                        <h4>ÊµãËØïÊèèËø∞Ôºö</h4>
                                        <div class="test-description-content" v-html="formatTestDescription(unitCase.test_description || unitCase.description || 'ËØ•ÂçïÂÖÉÊµãËØïÁî®‰∫éÈ™åËØÅÊñá‰ª∂‰∏≠Ê†∏ÂøÉÂäüËÉΩÁöÑÊ≠£Á°ÆÊÄß')"></div>
                                    </div>
                                    
                                    <!-- ‰ª£Á†ÅÈÉ®ÂàÜ - ÈªòËÆ§Êî∂Ëµ∑ -->
                                    <el-collapse style="margin-top: 15px;">
                                        <el-collapse-item title="Êü•ÁúãÊµãËØï‰ª£Á†Å" :name="`code-${index}`">
                                            <template #icon="{ isActive }">
                                                <el-button
                                                    size="mini"
                                                    type="text"
                                                    icon="el-icon-copy-document"
                                                    @click.stop="copyCode(unitCase.unit_test_code || unitCase.code)">
                                                    Â§çÂà∂‰ª£Á†Å
                                                </el-button>
                                            </template>
                                            <div class="code-block">
                                                 <pre><code v-text="unitCase.unit_test_code || unitCase.code || 'ÊöÇÊó†ÊµãËØï‰ª£Á†Å'"></code></pre>
                                            </div>
                                        </el-collapse-item>
                                    </el-collapse>
                                </el-card>
                            </div>
                        </div>
                        <div v-else>
                            <el-empty description="ÊöÇÊó†ÂçïÂÖÉÊµãËØïÁî®‰æã"></el-empty>
                        </div>
                    </el-tab-pane>
                    
                    <!-- Âú∫ÊôØÊµãËØïÁî®‰æã -->
                    <el-tab-pane label="Âú∫ÊôØÊµãËØïÁî®‰æã" name="scenario">
                        <div v-if="currentTask.status === 'completed' && currentTask.result && currentTask.result.scenario_cases">
                            <!-- ÊåâÊ®°ÂùóÂàÜÁªÑÂ±ïÁ§∫ -->
                            <div v-for="(moduleGroup, moduleName) in groupedScenarioCases" :key="moduleName" style="margin-bottom: 20px;">
                                <el-card class="module-group-card">
                                    <div slot="header" class="module-header">
                                        <i class="el-icon-folder-opened"></i>
                                        <span class="module-name" v-text="moduleName"></span>
                                        <el-tag size="small" type="info" v-text="moduleGroup.length +'‰∏™Áî®‰æã'" style="margin-left: 8px;"></el-tag>
                                    </div>
                                    
                                    <!-- Âú∫ÊôØÊµãËØïÂç°ÁâáÂ±ïÁ§∫ -->
                                    <el-row :gutter="20">
                                        <el-col :span="12" v-for="(scenario, index) in moduleGroup" :key="index">
                                            <el-card class="scenario-card" shadow="hover" style="margin-bottom: 15px;">
                                                <div slot="header" class="scenario-header">
                                                    <div class="scenario-title-info" style="display: flex;white-space: nowrap;overflow: hidden;">
                                                        <span class="scenario-title" v-text="scenario.title"></span>
                                                        <div class="scenario-tags" style="display: flex;white-space: nowrap;overflow: hidden;">
                                                            <el-tag size="mini" type="primary" v-text="scenario.case_id"></el-tag>
                                                            <el-tooltip
                                                                :content="scenario.filename"
                                                                placement="top"
                                                                effect="dark"
                                                                :disabled="isTooltipDisabled"
                                                            >
                                                                <el-tag size="mini" type="success" v-text="scenario.filename" @mouseenter="isTooltipDisabled = $event.target.scrollWidth < $event.target.clientWidth" style="flex: 1 1 0%;text-align: left;overflow: hidden;justify-content: left;text-overflow: ellipsis;white-space: nowrap;"></el-tag>
                                                            </el-tooltip>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="scenario-content">
                                                    <div class="scenario-section">
                                                        <h5 class="section-title">
                                                            <i class="el-icon-setting" style="color: #f39c12;"></i>
                                                            ÂâçÁΩÆÊù°‰ª∂
                                                        </h5>
                                                        <div class="section-content" v-if="Array.isArray(scenario.preconditions)">
                                                            <ul class="content-list">
                                                                <li v-for="(item, idx) in scenario.preconditions" :key="idx" v-text="item"></li>
                                                            </ul>
                                                        </div>
                                                        <div class="section-content" v-else>
                                                            <p class="content-text-multiline" v-html="formatTextWithLineBreaks(scenario.preconditions)"></p>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="scenario-section">
                                                        <h5 class="section-title">
                                                            <i class="el-icon-s-operation" style="color: #3498db;"></i>
                                                            Êìç‰ΩúÊ≠•È™§
                                                        </h5>
                                                        <div class="section-content" v-if="Array.isArray(scenario.steps)">
                                                            <ol class="content-list ordered-list">
                                                                <li v-for="(step, idx) in scenario.steps" :key="idx">
                                                                    {{ "{{ step.replace(/^\\d+\\.\\s*/, '') }}" }}
                                                                </li>
                                                            </ol>
                                                        </div>
                                                        <div class="section-content" v-else>
                                                            <p class="content-text-multiline" v-html="formatTextWithLineBreaks(scenario.steps)"></p>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="scenario-section">
                                                        <h5 class="section-title">
                                                            <i class="el-icon-success" style="color: #27ae60;"></i>
                                                            È¢ÑÊúüÁªìÊûú
                                                        </h5>
                                                        <div class="section-content" v-if="Array.isArray(scenario.expected_result)">
                                                            <ul class="content-list">
                                                                <li v-for="(item, idx) in scenario.expected_result" :key="idx" v-text="item"></li>
                                                            </ul>
                                                        </div>
                                                        <div class="section-content" v-else>
                                                            <p class="content-text-multiline" v-html="formatTextWithLineBreaks(scenario.expected_result)"></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </el-card>
                                        </el-col>
                                    </el-row>
                                </el-card>
                            </div>
                        </div>
                        <div v-else>
                            <el-empty description="ÊöÇÊó†Âú∫ÊôØÊµãËØïÁî®‰æã"></el-empty>
                        </div>
                    </el-tab-pane>
                </el-tabs>
            </div>
        </div>

        <!-- ÂéÜÂè≤‰ªªÂä°ÊäΩÂ±â -->
        <!-- ‰ªìÂ∫ìÂú∞ÂùÄÂΩïÂÖ•ÂØπËØùÊ°Ü -->
        <el-drawer v-model="repoDialogVisible" title="Ê∑ªÂä†Git‰ªìÂ∫ì" :close-on-click-modal="false" size="45%" class="history-drawer">
            <el-form :model="repoForm" label-width="100px" v-loading="repoFormLoading">
                <el-form-item label="‰ªìÂ∫ìÂú∞ÂùÄ" required>
                    <el-input 
                        v-model="repoForm.repoUrl" 
                        placeholder="ËØ∑ËæìÂÖ•Git‰ªìÂ∫ìÂú∞ÂùÄÔºåÂ¶ÇÔºöhttps://github.com/user/repo"
                        clearable
                    ></el-input>
                    <div style="margin-top: 5px; font-size: 12px; color: #909399;">
                        ÊîØÊåÅGitHub„ÄÅGitLabÁ≠âGitÊâòÁÆ°Âπ≥Âè∞
                    </div>
                </el-form-item>
                
                <el-form-item label="Á≥ªÁªüÂêçÁß∞" required>
                    <el-input 
                        v-model="repoForm.systemName" 
                        placeholder="ËØ∑ËæìÂÖ•Á≥ªÁªüÂêçÁß∞ÔºåÂ¶ÇÔºöÁî®Êà∑ÁÆ°ÁêÜÁ≥ªÁªü"
                        clearable
                    ></el-input>
                </el-form-item>
                
                <el-form-item label="ÊèèËø∞‰ø°ÊÅØ">
                    <el-input 
                        v-model="repoForm.description" 
                        type="textarea" 
                        :rows="3"
                        placeholder="ËØ∑ËæìÂÖ•È°πÁõÆÊèèËø∞ÔºàÂèØÈÄâÔºâ"
                    ></el-input>
                </el-form-item>
            </el-form>
            
            <template #footer>
                <div class="dialog-footer">
                    <el-button @click="repoDialogVisible = false">ÂèñÊ∂à</el-button>
                    <el-button 
                        type="primary" 
                        @click="addRepository" 
                        :loading="repoFormLoading"
                        :disabled="!repoForm.repoUrl || !repoForm.systemName"
                    >
                        Ê∑ªÂä†‰ªìÂ∫ì
                    </el-button>
                </div>
            </template>
            <el-table
                v-if="repoList.length > 0"
                :data="repoList"
                style="margin-top: 20px;"
                :border="true"
                :cell-style="cellStyle"
                :header-cell-style="headerCellStyle"
                stripe border max-height="calc(100vh - 220px)"
            >
                <template #empty>
                    <div class="custom-empty-text">
                        ÊöÇÊó†Êï∞ÊçÆ
                    </div>
                </template>
                <el-table-column label="Á≥ªÁªüÂêçÁß∞" prop="name">
                    <template #default="scope">
                        <span v-text="scope.row.name" ></span>
                    </template>
                </el-table-column>
                <el-table-column label="‰ªìÂ∫ìÂú∞ÂùÄ" prop="git_provider_url">
                    <template #default="scope">
                        <el-tooltip
                            :content="scope.row.git_provider_url"
                            placement="top"
                            effect="dark"
                            :disabled="isTooltipDisabled"
                        >
                            <span v-text="scope.row.git_provider_url" @mouseenter="isTooltipDisabled = $event.target.scrollWidth < $event.target.clientWidth" style="flex: 1 1 0%;direction: rtl;unicode-bidi: plaintext;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;"></span>
                        </el-tooltip>
                    </template>
                </el-table-column>
                <el-table-column label="Êìç‰Ωú" width="60px">
                    <template #default="scope">
                        <el-button type="text" @click="deleteRepository(scope.row.name)">Âà†Èô§</el-button>
                    </template>
                </el-table-column>
            </el-table>
        </el-drawer>

        <!-- ÈÄöÁü•ÈÖçÁΩÆÂØπËØùÊ°Ü -->
        <el-drawer v-model="notificationDialogVisible" title="ÈÄöÁü•ÈÖçÁΩÆ" :close-on-click-modal="false"  size="45%" class="history-drawer">
            <div v-loading="notificationLoading">
                <!-- ÈÇÆ‰ª∂ÈÄöÁü•ÈÖçÁΩÆ -->
                <el-card class="notification-section" shadow="hover">
                    <template #header>
                        <div class="notification-header">
                            <el-icon><i class="el-icon-message"></i></el-icon>
                            <span>ÈÇÆ‰ª∂ÈÄöÁü•</span>
                            <el-switch 
                                v-model="notificationConfig.email.enabled" 
                                class="notification-switch"
                                active-text="ÂêØÁî®"
                                inactive-text="Á¶ÅÁî®"
                            ></el-switch>
                        </div>
                    </template>
                    
                    <div v-if="notificationConfig.email.enabled">
                        <!-- SMTPÈÖçÁΩÆÁä∂ÊÄÅ -->
                        <el-alert 
                            v-if="!notificationConfig.email.smtp_configured"
                            title="SMTPÊúçÂä°Âô®Êú™ÈÖçÁΩÆ" 
                            type="warning" 
                            :closable="false"
                            show-icon
                            style="margin-bottom: 15px;"
                        >
                            ËØ∑Âú®ÁéØÂ¢ÉÂèòÈáè‰∏≠ÈÖçÁΩÆ NOTIFICATION_EMAIL_SMTP_SERVER Á≠âÂèÇÊï∞
                        </el-alert>
                        
                        <!-- Êî∂‰ª∂‰∫∫ÁÆ°ÁêÜ -->
                        <div class="email-recipients">
                            <label class="config-label">Êî∂‰ª∂‰∫∫ÈÇÆÁÆ±Ôºö</label>
                            <div class="recipients-input">
                                <el-input
                                    v-model="newEmailRecipient"
                                    placeholder="ËæìÂÖ•ÈÇÆÁÆ±Âú∞ÂùÄ"
                                    @keyup.enter="addEmailRecipient"
                                    style="flex: 1; margin-right: 10px;"
                                ></el-input>
                                <el-button type="primary" @click="addEmailRecipient" :disabled="!isValidEmail(newEmailRecipient)">
                                    Ê∑ªÂä†
                                </el-button>
                            </div>
                            
                            <!-- Êî∂‰ª∂‰∫∫ÂàóË°® -->
                            <div class="recipients-list" v-if="notificationConfig.email.recipients.length > 0">
                                <el-tag
                                    v-for="(email, index) in notificationConfig.email.recipients"
                                    :key="index"
                                    :type="isValidEmail(email) ? 'primary' : 'danger'"
                                    closable
                                    @close="removeEmailRecipient(index)"
                                    style="margin: 5px 5px 0 0;"
                                    v-text="email"
                                >
                                </el-tag>
                            </div>
                            
                            <div v-else class="no-recipients">
                                <el-text type="info">ÊöÇÊó†Êî∂‰ª∂‰∫∫</el-text>
                            </div>
                        </div>
                    </div>
                </el-card>
                
                <!-- ‰ºÅ‰∏öÂæÆ‰ø°ÈÄöÁü•ÈÖçÁΩÆ -->
                <el-card class="notification-section" shadow="hover" style="margin-top: 20px;">
                    <template #header>
                        <div class="notification-header">
                            <el-icon><i class="el-icon-chat-dot-round"></i></el-icon>
                            <span>‰ºÅ‰∏öÂæÆ‰ø°ÈÄöÁü•</span>
                            <el-switch 
                                v-model="notificationConfig.wechat_work.enabled" 
                                class="notification-switch"
                                active-text="ÂêØÁî®"
                                inactive-text="Á¶ÅÁî®"
                            ></el-switch>
                        </div>
                    </template>
                    
                    <div v-if="notificationConfig.wechat_work.enabled">
                        <!-- WebhookÈÖçÁΩÆÁä∂ÊÄÅ -->
                        <el-alert 
                            v-if="!notificationConfig.wechat_work.webhook_configured"
                            title="Webhook URLÊú™ÈÖçÁΩÆ" 
                            type="warning" 
                            :closable="false"
                            show-icon
                            style="margin-bottom: 15px;"
                        >
                            ËØ∑Âú®ÁéØÂ¢ÉÂèòÈáè‰∏≠ÈÖçÁΩÆ NOTIFICATION_WECHAT_WEBHOOK_URL
                        </el-alert>
                        
                        <!-- @ÊèêÈÜíÁî®Êà∑ -->
                        <div class="wechat-mentions">
                            <label class="config-label">@ÊèêÈÜíÁî®Êà∑Ôºö</label>
                            <div class="mentions-input">
                                <el-input
                                    v-model="newWechatMention"
                                    placeholder="ËæìÂÖ•Áî®Êà∑ID"
                                    @keyup.enter="addWechatMention"
                                    style="flex: 1; margin-right: 10px;"
                                ></el-input>
                                <el-button type="primary" @click="addWechatMention" :disabled="!newWechatMention.trim()">
                                    Ê∑ªÂä†
                                </el-button>
                            </div>
                            
                            <!-- ÊèêÈÜíÁî®Êà∑ÂàóË°® -->
                            <div class="mentions-list" v-if="notificationConfig.wechat_work.mentioned_list.length > 0">
                                <el-tag
                                    v-for="(user, index) in notificationConfig.wechat_work.mentioned_list"
                                    :key="index"
                                    type="success"
                                    closable
                                    @close="removeWechatMention(index)"
                                    style="margin: 5px 5px 0 0;"
                                >
                                    @{{ user }}
                                </el-tag>
                            </div>
                            
                            <div v-else class="no-mentions">
                                <el-text type="info">ÊöÇÊó†@ÊèêÈÜíÁî®Êà∑</el-text>
                            </div>
                        </div>
                    </div>
                </el-card>
            </div>
            
            <template #footer>
                <div class="dialog-footer">
                    <el-button @click="notificationDialogVisible = false">ÂèñÊ∂à</el-button>
                    <el-button type="primary" @click="saveNotificationConfig" :loading="savingConfig">
                        ‰øùÂ≠òÈÖçÁΩÆ
                    </el-button>
                    <el-button 
                        type="success" 
                        @click="testNotification" 
                        :disabled="!canTestNotification"
                        :loading="testingNotification"
                    >
                        ÊµãËØïÈÄöÁü•
                    </el-button>
                </div>
            </template>
        </el-drawer>

        <el-drawer v-model="showHistory" title="üìã ÂéÜÂè≤‰ªªÂä°" size="45%" class="history-drawer">
            <div class="history-header">
                <el-button size="small" @click="loadTasks" :loading="historyLoading" type="primary" icon="Refresh">
                    Âà∑Êñ∞
                </el-button>
                <el-input 
                    size="small" 
                    v-model="keyword"
                    @input="debouncedSearch" 
                    placeholder="ÊêúÁ¥¢‰ªªÂä°ID„ÄÅÁ≥ªÁªüÊàñÂàÜÊîØ"
                    clearable
                    style="flex: 1; margin-left: 12px;">
                    <template #prefix>
                        <el-icon><Search /></el-icon>
                    </template>
                </el-input>
            </div>
            
            <div v-loading="historyLoading" element-loading-text="Âä†ËΩΩÂéÜÂè≤‰ªªÂä°..." class="history-content">
                <div v-if="filteredTasks.length === 0" class="empty-state">
                    <el-empty description="ÊöÇÊó†ÂéÜÂè≤‰ªªÂä°" :image-size="120"></el-empty>
                </div>
                <div v-else>

                    <!-- ËôöÊãüÊªöÂä®ÂÆπÂô® -->
                    <div class="virtual-scroll-container" 
                         :style="{ height: 'calc(100vh - 200px)', overflow: 'auto' }"
                         @scroll="handleVirtualScroll">
                        
                        <!-- ËôöÊãüÊªöÂä®Âç†‰ΩçÂÆπÂô® -->
                        <div class="virtual-placeholder" :style="{ height: virtualContainerHeight + 'px', position: 'relative' }">
                            
                            <!-- ÂèØËßÅ‰ªªÂä°ÂàóË°® -->
                            <div class="virtual-items" 
                                 :style="{ transform: `translateY(${virtualOffsetY}px)` }">
                                
                                <div v-for="(task, index) in visibleTasks" 
                                     :key="task.id" 
                                     class="history-task-card virtual-item"
                                     :style="{ height: virtualListConfig.itemHeight + 'px' }">
                                    <el-card shadow="hover" class="task-card-enhanced">
                                        <div class="task-card-header">
                                            <div class="task-info">
                                                <div class="task-id-row">
                                                    <el-icon style="margin-right: 6px; color: #409eff;"><Document /></el-icon>
                                                    <el-link 
                                                        :href="getTaskReportUrl(task.id)" 
                                                        target="_blank"
                                                        type="primary"
                                                        class="task-id-link"
                                                        :title="'ÁÇπÂáªÊü•Áúã‰ªªÂä° ' + task.id + ' ÁöÑËØ¶ÁªÜÊä•Âëä'"
                                                        style="font-size: 13px;" >
                                                        {{ "{{ task.id }}" }}
                                                    </el-link>
                                                    <el-tag :type="getStatusTagType(task.status)" size="small" class="status-tag" style="margin-left: 12px;">
                                                        {{ "{{ task.status }}" }}
                                                    </el-tag>
                                                </div>

                                                <div class="task-details">
                                                    <div class="detail-item">
                                                        <el-icon style="margin-right: 4px; color: #67c23a;"><Monitor /></el-icon>
                                                        <span class="label">Á≥ªÁªüÔºö</span>
                                                        <span class="value">{{ "{{ task.system_name }}" }}</span>
                                                    </div>
                                                    <div class="detail-item">
                                                        <el-icon style="margin-right: 4px; color: #e6a23c;"><Guide /></el-icon>
                                                        <span class="label">ÂàÜÊîØÔºö</span>
                                                        <el-tooltip
                                                            :content="task.branch_name"
                                                            placement="top"
                                                            effect="dark"
                                                            :disabled="isTooltipDisabled"
                                                        >
                                                            <span class="value" @mouseenter="isTooltipDisabled = $event.target.scrollWidth < $event.target.clientWidth" style="max-width: 100%; unicode-bidi: plaintext; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ "{{ task.branch_name }}" }}</span>
                                                        </el-tooltip>
                                                    </div>
                                                    <div class="detail-item" v-if="task.summary && task.summary.total_issues_found">
                                                        <el-icon style="margin-right: 4px; color: #f56c6c;"><Warning /></el-icon>
                                                        <span class="label">ÈóÆÈ¢òÔºö</span>
                                                        <span class="value">{{ "{{ task.summary.total_issues_found || 0 }}" }} ‰∏™</span>
                                                    </div>
                                                    <div class="detail-item" v-if="task.summary && task.summary.total_scenario_tests">
                                                        <el-icon style="margin-right: 4px; color: #67c23a;"><Check /></el-icon>
                                                        <span class="label">ÊµãËØïÁî®‰æãÔºö</span>
                                                        <span class="value">{{ "{{ task.summary.total_scenario_tests || 0 }}" }} ‰∏™</span>
                                                    </div>
                                                </div>
                                                <div v-if="task.summary && task.summary.total_issues_found && task.summary.total_issues_found" class="task-time" style="margin: -60px auto  auto 167px;">
                                                    <div class="time-item">
                                                        <el-icon style="margin-right: 4px; color: #909399;"><Clock /></el-icon>
                                                        <span class="label">ÂàõÂª∫Ôºö</span>
                                                        <span class="value">{{ "{{ formatDateTime(task.created_at) }}" }}</span>
                                                    </div>
                                                    <div class="time-item">
                                                        <el-icon style="margin-right: 4px; color: #909399;"><Edit /></el-icon>
                                                        <span class="label">Êõ¥Êñ∞Ôºö</span>
                                                        <span class="value">{{ "{{ formatDateTime(task.updated_at) }}" }}</span>
                                                    </div>
                                                    <div class="time-item" v-if="task.result && task.result.execution_time">
                                                        <el-icon style="margin-right: 4px; color: #409eff;"><Timer /></el-icon>
                                                        <span class="label">ËÄóÊó∂Ôºö</span>
                                                        <span class="value">{{ "{{ task.result.execution_time }}" }}s</span>
                                                    </div>
                                                </div>
                                                <div v-else>
                                                    <div class="time-item">
                                                        <el-icon style="margin-right: 4px; color: #909399;"><Clock /></el-icon>
                                                        <span class="label">ÂàõÂª∫Ôºö</span>
                                                        <span class="value">{{ "{{ formatDateTime(task.created_at) }}" }}</span>
                                                    </div>
                                                    <div class="time-item">
                                                        <el-icon style="margin-right: 4px; color: #909399;"><Edit /></el-icon>
                                                        <span class="label">Êõ¥Êñ∞Ôºö</span>
                                                        <span class="value">{{ "{{ formatDateTime(task.updated_at) }}" }}</span>
                                                    </div>
                                                    <div class="time-item" v-if="task.result && task.result.execution_time">
                                                        <el-icon style="margin-right: 4px; color: #409eff;"><Timer /></el-icon>
                                                        <span class="label">ËÄóÊó∂Ôºö</span>
                                                        <span class="value">{{ "{{ task.result.execution_time }}" }}s</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="task-actions">
                                                <el-button size="small" type="primary" @click="viewTask(task.id)" icon="View" style="margin-left: 12px;">
                                                    Êü•ÁúãËØ¶ÊÉÖ
                                                </el-button>
                                                <el-button 
                                                    size="small" 
                                                    type="success" 
                                                    @click="copyTaskReportUrl(task.id)" 
                                                    icon="Link"
                                                    title="Â§çÂà∂Êä•ÂëäÈìæÊé•">
                                                    Â§çÂà∂ÈìæÊé•
                                                </el-button>
                                            </div>
                                        </div>
                                    </el-card>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ÊªöÂä®ÁªüËÆ°‰ø°ÊÅØ -->
                        <div v-if="filteredTasks.length > virtualListConfig.visibleCount" 
                             class="virtual-scroll-info">
                            <el-text size="small" type="info">
                                ÊòæÁ§∫ {{ "{{ visibleTasksRange.start + 1 }}" }}-{{ "{{ Math.min(visibleTasksRange.end, filteredTasks.length) }}" }} / {{ "{{ filteredTasks.length }}" }} È°π‰ªªÂä°
                            </el-text>
                        </div>
                    </div>
                </div>
            </div>
        </el-drawer>
    </div>


    <footer class="footer">
        <div class="container-fluid">
            <span class="text-muted"><a href="https://github.com/iguowz/codereview" target="_blank">CodeReview</a> Copyright ¬© 2025 iguo</span>
            <div class="text-muted">Licensed under the Apache License, Version 2.0</div>
        </div>
    </footer>

    <script>
        const { createApp, ref, onMounted, computed } = Vue;
        const { ElMessage, ElMessageBox } = ElementPlus;
        const { Refresh, Plus, Clock, Message, View, Close, Search, Grid, Link, Loading, Warning, Check, Document, CirclePlusFilled, RemoveFilled, Edit, Key, Monitor, Guide } = ElementPlusIconsVue;
        
        const app = createApp({
            setup() {
                const systems = ref([]);
                const selectedSystems = ref([]);
                const branchesOptionsList = ref([]);
                const branchesOptions = ref([]);
                const switchBranch = ref(true);
                const branchName = ref('');
                const systemsLoading = ref(false);
                const rateLimitDescription = ref('');
                const loading = ref(false);
                const abortLoading = ref(false);
                const currentTask = ref(null);
                const activeTab = ref('review');
                const form = ref({
                    system: '',
                    branch: ''
                });
                reportId= ref(null);

                // ÂéÜÂè≤‰ªªÂä°
                const showHistory = ref(false);
                const historyLoading = ref(false);
                const tasks = ref([]);
                const keyword = ref('');

                // ÈÄöÁü•ÈÖçÁΩÆ
                const notificationDialogVisible = ref(false);
                const notificationLoading = ref(false);
                const savingConfig = ref(false);
                const testingNotification = ref(false);
                const newEmailRecipient = ref('');
                const newWechatMention = ref('');

                // ÈîôËØØÂ§ÑÁêÜÁä∂ÊÄÅ
                const errorState = ref({
                    hasError: false,
                    errorMessage: '',
                    errorStack: '',
                    errorTime: null,
                    retryCount: 0
                });
                const maxRetries = 3;
                const retryDelay = 1000; // 1Áßí
                const notificationConfig = ref({
                    email: {
                        enabled: false,
                        recipients: [],
                        smtp_configured: false,
                        auth_configured: false
                    },
                    wechat_work: {
                        enabled: false,
                        mentioned_list: [],
                        mentioned_mobile_list: [],
                        webhook_configured: false
                    }
                });

                // ‰ªìÂ∫ìÂú∞ÂùÄÂΩïÂÖ•
                const repoDialogVisible = ref(false);
                const repoFormLoading = ref(false);
                const repoForm = ref({
                    repoUrl: '',
                    systemName: '',
                    provider: 'github',
                    description: ''
                });
                const repoList = ref([]);
                // Èò≤ÊäñÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠ó
                const debouncedKeyword = ref('');
                let searchTimer = null;
                
                const filteredTasks = computed(() => {
                    if (!debouncedKeyword.value) return tasks.value;
                    const k = debouncedKeyword.value.toLowerCase();
                    return tasks.value.filter(t =>
                        (t.system_name || '').toLowerCase().includes(k) ||
                        (t.branch_name || '').toLowerCase().includes(k) ||
                        (t.id || '').toLowerCase().includes(k)
                    );
                });

                // Èò≤ÊäñÊêúÁ¥¢ÂáΩÊï∞
                const debouncedSearch = (value) => {
                    if (searchTimer) clearTimeout(searchTimer);
                    searchTimer = setTimeout(() => {
                        debouncedKeyword.value = value;
                    }, 300);
                };
                
                // ÊåâÊ®°ÂùóÂàÜÁªÑÁöÑÂú∫ÊôØÊµãËØïÁî®‰æã
                const groupedScenarioCases = computed(() => {
                    if (!currentTask.value || !currentTask.value.result || !currentTask.value.result.scenario_cases) {
                        return {};
                    }
                    
                    const grouped = {};
                    currentTask.value.result.scenario_cases.forEach(scenario => {
                        const module = scenario.module || 'Êú™ÂàÜÁ±ªÊ®°Âùó';
                        if (!grouped[module]) {
                            grouped[module] = [];
                        }
                        grouped[module].push(scenario);
                    });
                    
                    return grouped;
                });

                // ÈÄöÁü•ÈÖçÁΩÆËÆ°ÁÆóÂ±ûÊÄß
                const canTestNotification = computed(() => {
                    const email = notificationConfig.value.email;
                    const wechat = notificationConfig.value.wechat_work;
                    
                    return (email.enabled && email.recipients.length > 0 && email.smtp_configured) ||
                           (wechat.enabled && wechat.webhook_configured);
                });

                // ÊÄßËÉΩ‰ºòÂåñËÆ°ÁÆóÂ±ûÊÄß
                const hasValidSystems = computed(() => {
                    return systems.value && systems.value.length > 0;
                });

                const selectedSystemsCount = computed(() => {
                    return selectedSystems.value.length;
                });

                const isTaskRunning = computed(() => {
                    return currentTask.value && ['pending', 'processing'].includes(currentTask.value.status);
                });

                const taskProgressPercent = computed(() => {
                    if (!currentTask.value || !currentTask.value.file_states) return 0;
                    const states = Object.values(currentTask.value.file_states);
                    if (states.length === 0) return 0;
                    const completed = states.filter(state => state.status === 'completed').length;
                    return Math.round((completed / states.length) * 100);
                });

                // ËôöÊãüÊªöÂä®ÈÖçÁΩÆ
                const virtualListConfig = ref({
                    itemHeight: 220,
                    visibleCount: 10,
                    bufferSize: 5,
                    scrollTop: 0
                });

                // ËôöÊãüÊªöÂä®ÂèØËßÅËåÉÂõ¥
                const visibleTasksRange = computed(() => {
                    const total = filteredTasks.value.length;
                    if (total <= virtualListConfig.value.visibleCount) {
                        return { start: 0, end: total, total };
                    }
                    
                    const scrollIndex = Math.floor(virtualListConfig.value.scrollTop / virtualListConfig.value.itemHeight);
                    const start = Math.max(0, scrollIndex - virtualListConfig.value.bufferSize);
                    const end = Math.min(total, scrollIndex + virtualListConfig.value.visibleCount + virtualListConfig.value.bufferSize);
                    
                    return { start, end, total };
                });

                // ËôöÊãüÊªöÂä®ÊòæÁ§∫ÁöÑ‰ªªÂä°
                const visibleTasks = computed(() => {
                    const range = visibleTasksRange.value;
                    return filteredTasks.value.slice(range.start, range.end);
                });

                // ËôöÊãüÊªöÂä®ÂÆπÂô®È´òÂ∫¶
                const virtualContainerHeight = computed(() => {
                    return filteredTasks.value.length * virtualListConfig.value.itemHeight + 70;
                });

                // ËôöÊãüÊªöÂä®ÂÅèÁßªÈáè
                const virtualOffsetY = computed(() => {
                    return visibleTasksRange.value.start * virtualListConfig.value.itemHeight;
                });

                // Â§ÑÁêÜËôöÊãüÊªöÂä®‰∫ã‰ª∂
                const handleVirtualScroll = (event) => {
                    virtualListConfig.value.scrollTop = event.target.scrollTop;
                };

                // ÈîôËØØÂ§ÑÁêÜÂáΩÊï∞
                const handleError = (error, context = '', showMessage = true) => {
                    console.error(`[${context}] ÈîôËØØ:`, error);
                    
                    errorState.value = {
                        hasError: true,
                        errorMessage: error.message || String(error),
                        errorStack: error.stack || '',
                        errorTime: new Date().toISOString(),
                        retryCount: errorState.value.retryCount + 1
                    };
                    
                    if (showMessage) {
                        ElMessage.error({
                            message: `${context ? context + ': ' : ''}${error.message || error}`,
                            duration: 5000,
                            showClose: true
                        });
                    }
                };

                // Ê∏ÖÈô§ÈîôËØØÁä∂ÊÄÅ
                const clearError = () => {
                    errorState.value = {
                        hasError: false,
                        errorMessage: '',
                        errorStack: '',
                        errorTime: null,
                        retryCount: 0
                    };
                };

                // Â∏¶ÈáçËØïÁöÑÂºÇÊ≠•ËØ∑Ê±ÇÂåÖË£ÖÂô®
                const withRetry = async (asyncFunction, context = '', maxRetries = 3) => {
                    for (let attempt = 1; attempt <= maxRetries; attempt++) {
                        try {
                            return await asyncFunction();
                        } catch (error) {
                            console.warn(`[${context}] Á¨¨ ${attempt} Ê¨°Â∞ùËØïÂ§±Ë¥•:`, error);
                            
                            if (attempt === maxRetries) {
                                handleError(error, context);
                                throw error;
                            }
                            
                            // Á≠âÂæÖÂêéÈáçËØï
                            await new Promise(resolve => setTimeout(resolve, retryDelay * attempt));
                        }
                    }
                };

                // ÂÆâÂÖ®ÁöÑ API Ë∞ÉÁî®ÂåÖË£ÖÂô®
                const safeApiCall = async (apiFunction, context = '', fallbackValue = null) => {
                    try {
                        return await withRetry(apiFunction, context);
                    } catch (error) {
                        console.error(`[${context}] API Ë∞ÉÁî®ÊúÄÁªàÂ§±Ë¥•:`, error);
                        return fallbackValue;
                    }
                };

                // ÂÜÖÂ≠òÁÆ°ÁêÜÂäüËÉΩ
                const memoryUsage = ref({
                    usedJSHeapSize: 0,
                    totalJSHeapSize: 0,
                    jsHeapSizeLimit: 0,
                    lastCleanup: null
                });

                // Êõ¥Êñ∞ÂÜÖÂ≠ò‰ΩøÁî®ÊÉÖÂÜµ
                const updateMemoryUsage = () => {
                    if (performance.memory) {
                        memoryUsage.value = {
                            usedJSHeapSize: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024), // MB
                            totalJSHeapSize: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024), // MB
                            jsHeapSizeLimit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024), // MB
                            lastCleanup: memoryUsage.value.lastCleanup
                        };
                    }
                };

                // ÂÜÖÂ≠òÊ∏ÖÁêÜÂáΩÊï∞
                const cleanupMemory = () => {
                    try {
                        // Ê∏ÖÁêÜÂ§ßÊï∞ÁªÑÂíåÂØπË±°
                        if (tasks.value.length > 1000) {
                            // Âè™‰øùÁïôÊúÄËøëÁöÑ 500 ‰∏™‰ªªÂä°
                            tasks.value = tasks.value.slice(-500);
                            console.log('üßπ Ê∏ÖÁêÜ‰∫ÜÂéÜÂè≤‰ªªÂä°Êï∞ÊçÆ');
                        }

                        // Ê∏ÖÁêÜÊú™‰ΩøÁî®ÁöÑÁ≥ªÁªüÊï∞ÊçÆ
                        if (systems.value.length > 0) {
                            systems.value.forEach(system => {
                                if (system.projects && system.projects.length > 100) {
                                    system.projects = system.projects.slice(0, 100);
                                }
                            });
                        }

                        // Âº∫Âà∂ÂûÉÂúæÂõûÊî∂Ôºà‰ªÖÂú®ÂºÄÂèëÁéØÂ¢ÉÔºâ
                        if (window.gc && typeof window.gc === 'function') {
                            window.gc();
                            console.log('üßπ ÊâßË°å‰∫ÜÂûÉÂúæÂõûÊî∂');
                        }

                        memoryUsage.value.lastCleanup = new Date().toISOString();
                        updateMemoryUsage();
                        
                        ElMessage.success('ÂÜÖÂ≠òÊ∏ÖÁêÜÂÆåÊàê');
                    } catch (error) {
                        handleError(error, 'ÂÜÖÂ≠òÊ∏ÖÁêÜ');
                    }
                };

                // Ëá™Âä®ÂÜÖÂ≠òÁõëÊéß
                const memoryMonitorInterval = ref(null);
                const startMemoryMonitoring = () => {
                    memoryMonitorInterval.value = setInterval(() => {
                        updateMemoryUsage();
                        
                        // ÂΩìÂÜÖÂ≠ò‰ΩøÁî®Ë∂ÖËøáÈòàÂÄºÊó∂Ëá™Âä®Ê∏ÖÁêÜ
                        const usedMemoryMB = memoryUsage.value.usedJSHeapSize;
                        const memoryLimit = memoryUsage.value.jsHeapSizeLimit;
                        
                        if (usedMemoryMB > memoryLimit * 0.8) { // ‰ΩøÁî®Ë∂ÖËøá 80% Êó∂Ê∏ÖÁêÜ
                            console.warn('‚ö†Ô∏è ÂÜÖÂ≠ò‰ΩøÁî®ËøáÈ´òÔºåÂºÄÂßãËá™Âä®Ê∏ÖÁêÜ');
                            cleanupMemory();
                        }
                    }, 30000); // ÊØè 30 ÁßíÊ£ÄÊü•‰∏ÄÊ¨°
                };

                const stopMemoryMonitoring = () => {
                    if (memoryMonitorInterval.value) {
                        clearInterval(memoryMonitorInterval.value);
                        memoryMonitorInterval.value = null;
                    }
                };

                // ÊÄßËÉΩ‰ºòÂåñÁöÑ debounce ÂáΩÊï∞
                const createDebounce = (func, delay) => {
                    let timeoutId;
                    return (...args) => {
                        clearTimeout(timeoutId);
                        timeoutId = setTimeout(() => func.apply(this, args), delay);
                    };
                };

                // Èò≤ÊäñÁöÑÊêúÁ¥¢ÂíåÊï∞ÊçÆÊõ¥Êñ∞
                const debouncedSystemsUpdate = createDebounce(() => {
                    console.log('üîÑ Á≥ªÁªüÊï∞ÊçÆÊõ¥Êñ∞');
                }, 500);

                /* Êñ∞Â¢û‰∏Ä‰∏™ treeData */
                const treeData = computed(() => {
                  if (!systems.value.length) return [];

                  return systems.value.map(sys => ({
                    value: sys.name,               // Á≥ªÁªüÁ∫ßËäÇÁÇπÂÄº
                    label: `${sys.name}Ôºà${sys.projects?.length || 0}‰∏™È°πÁõÆÔºâ`,
                    disabled: false,
                    // ÈÄíÂΩíÂ§ÑÁêÜ projectsÔºàÊîØÊåÅÊó†ÈôêÁ∫ßÔºâ
                    children: buildProjectNodes(sys.projects, sys.name)
                  }));
                });

                /* ÈÄíÂΩíÊûÑÂª∫È°πÁõÆÊ†ëÔºàÂÖºÂÆπÂ≠óÁ¨¶‰∏≤ / ÂØπË±°Ôºâ */
                function buildProjectNodes(list, prefix) {
                  if (!Array.isArray(list) || !list.length) return [];

                  return list.map(item => {
                    // 1. Â¶ÇÊûúÊòØÂ≠óÁ¨¶‰∏≤ÔºåÁõ¥Êé•ÂΩìÊàêÈ°πÁõÆÂêçÁß∞
                    if (typeof item === 'string') {
                      return {
                        value: `${item}`,
                        label: `${item}`
                      };
                    }

                    // 2. Â¶ÇÊûúÊòØÂØπË±°Ôºà‰ª•ÂêéÁ´ØÊâ©Â±ï‰∫Ü children Â≠óÊÆµÔºâ
                    const node = {
                      value: `${prefix}:${item.name}`,
                      label: `${prefix}Ôºà${item.name}Ôºâ`
                    };
                    if (item.children?.length) {
                      node.children = buildProjectNodes(item.children, node.value);
                    }
                    return node;
                  });
                }

                // ÈÄöÁü•ÈÖçÁΩÆÁõ∏ÂÖ≥ÊñπÊ≥ï
                const openNotificationConfig = async () => {
                    notificationDialogVisible.value = true;
                    await loadNotificationConfig();
                };

                const loadNotificationConfig = async () => {
                    try {
                        notificationLoading.value = true;
                        const response = await fetch('/api/notifications/config');
                        const data = await response.json();
                        
                        if (data.success) {
                            notificationConfig.value = data.config;
                        } else {
                            ElMessage.error('Âä†ËΩΩÈÄöÁü•ÈÖçÁΩÆÂ§±Ë¥•: ' + data.error);
                        }
                    } catch (error) {
                        console.error('Âä†ËΩΩÈÄöÁü•ÈÖçÁΩÆÂ§±Ë¥•:', error);
                        ElMessage.error('Âä†ËΩΩÈÄöÁü•ÈÖçÁΩÆÂ§±Ë¥•');
                    } finally {
                        notificationLoading.value = false;
                    }
                };

                const saveNotificationConfig = async () => {
                    try {
                        savingConfig.value = true;
                        
                        const response = await fetch('/api/notifications/config', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(notificationConfig.value)
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            ElMessage.success('ÈÄöÁü•ÈÖçÁΩÆ‰øùÂ≠òÊàêÂäü');
                            notificationDialogVisible.value = false;
                        } else {
                            ElMessage.error('‰øùÂ≠òÂ§±Ë¥•: ' + data.error);
                        }
                    } catch (error) {
                        console.error('‰øùÂ≠òÈÄöÁü•ÈÖçÁΩÆÂ§±Ë¥•:', error);
                        ElMessage.error('‰øùÂ≠òÈÄöÁü•ÈÖçÁΩÆÂ§±Ë¥•');
                    } finally {
                        savingConfig.value = false;
                    }
                };

                const testNotification = async () => {
                    try {
                        testingNotification.value = true;
                        
                        const providers = [];
                        const recipients = [];
                        console.log(notificationConfig.value);
                        if (notificationConfig.value.email.enabled && notificationConfig.value.email.recipients.length > 0) {
                            providers.push('email');
                            recipients.push(...notificationConfig.value.email.recipients);
                        }
                        console.log(recipients);
                        if (notificationConfig.value.wechat_work.enabled) {
                            providers.push('wechat_work');
                            recipients.push('test'); // ‰ºÅ‰∏öÂæÆ‰ø°‰∏çÈúÄË¶ÅÂÖ∑‰ΩìÊî∂‰ª∂‰∫∫
                        }

                        if (providers.length === 0) {
                            ElMessage.warning('ËØ∑ÂÖàÂêØÁî®Ëá≥Â∞ë‰∏Ä‰∏™ÈÄöÁü•Ê∏†ÈÅìÂπ∂Â°´ÂÜôÊî∂‰ª∂‰∫∫');
                            return;
                        }
                        
                        const results = [];
                        for (const p of providers) {
                            const res = await fetch('/api/notifications/test', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    provider: p,
                                    recipients: p === 'email' ? notificationConfig.value.email.recipients : ['test'],
                                    message: 'ËøôÊòØ‰∏ÄÊù°ÊµãËØïÊ∂àÊÅØÔºåÁî®‰∫éÈ™åËØÅÈÄöÁü•ÈÖçÁΩÆÊòØÂê¶Ê≠£Á°Æ„ÄÇ'
                                })
                            });
                            const data = await res.json();
                            results.push({ provider: p, success: data.success, error: data.error });
                        }

                        const failed = results.filter(r => !r.success);
                        if (failed.length) {
                            ElMessage.error(`ÈÉ®ÂàÜÊµãËØïÂ§±Ë¥•Ôºö${failed.map(f => f.provider).join(', ')}`);
                        } else {
                            ElMessage.success('ÊâÄÊúâÈÄöÁü•Ê∏†ÈÅìÊµãËØïÊàêÂäü');
                        }

                    } catch (error) {
                        console.error('ÊµãËØïÈÄöÁü•ÂèëÈÄÅÂ§±Ë¥•:', error);
                        ElMessage.error('ÊµãËØïÈÄöÁü•ÂèëÈÄÅÂ§±Ë¥•');
                    } finally {
                        testingNotification.value = false;
                    }
                };

                const isValidEmail = (email) => {
                    if (!email || typeof email !== 'string') return false;
                    const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                    return emailRegex.test(email.trim());
                };

                const addEmailRecipient = () => {
                    const email = newEmailRecipient.value.trim();
                    if (!email) return;
                    
                    if (!isValidEmail(email)) {
                        ElMessage.error('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ');
                        return;
                    }
                    
                    if (notificationConfig.value.email.recipients.includes(email)) {
                        ElMessage.warning('ËØ•ÈÇÆÁÆ±Â∑≤Â≠òÂú®');
                        return;
                    }
                    
                    notificationConfig.value.email.recipients.push(email);
                    newEmailRecipient.value = '';
                };

                const removeEmailRecipient = (index) => {
                    notificationConfig.value.email.recipients.splice(index, 1);
                };

                const addWechatMention = () => {
                    const mention = newWechatMention.value.trim();
                    if (!mention) return;
                    
                    if (notificationConfig.value.wechat_work.mentioned_list.includes(mention)) {
                        ElMessage.warning('ËØ•Áî®Êà∑Â∑≤Â≠òÂú®');
                        return;
                    }
                    
                    notificationConfig.value.wechat_work.mentioned_list.push(mention);
                    newWechatMention.value = '';
                };

                const removeWechatMention = (index) => {
                    notificationConfig.value.wechat_work.mentioned_list.splice(index, 1);
                };

                // ‰ªìÂ∫ìÂΩïÂÖ•Áõ∏ÂÖ≥ÊñπÊ≥ï
                const openRepoDialog = () => {
                    repoDialogVisible.value = true;
                    // ÈáçÁΩÆË°®Âçï
                    repoForm.value = {
                        repoUrl: '',
                        systemName: '',
                        provider: 'github',
                        description: ''
                    };
                };

                const parseGitUrl = (url) => {
                    // Ëß£ÊûêGit URLÔºåÊèêÂèñgit_providerÂíågit_provider_url‰ø°ÊÅØ
                    try {
                        const urlObj = new URL(url);
                        let provider = 'other';
                        if (urlObj.hostname.includes('github.com')) {
                            provider = 'github';
                        } else if (urlObj.hostname.includes('gitlab.com')) {
                            provider = 'gitlab';
                        } else if (urlObj.hostname.includes('gitee.com')) {
                            provider = 'gitee';
                        }

                        return { provider, valid: true };
                    } catch (e) {
                        console.error('Ëß£ÊûêGit URLÂ§±Ë¥•:', e);
                    }
                    return { valid: false };
                };

                const addRepository = async () => {
                    try {
                        repoFormLoading.value = true;
                        
                        // Ëß£Êûê‰ªìÂ∫ìURL
                        const urlInfo = parseGitUrl(repoForm.value.repoUrl);
                        if (!urlInfo.valid) {
                            ElMessage.error('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑGit‰ªìÂ∫ìÂú∞ÂùÄ');
                            return;
                        }
                        
                        // ÊûÑÈÄ†Á≥ªÁªüÈÖçÁΩÆ
                        const systemConfig = {
                            id: repoForm.value.systemName.toLowerCase().replace(/\s+/g, '-'),
                            name: repoForm.value.systemName,
                            git_provider: urlInfo.provider,
                            git_provider_url: repoForm.value.repoUrl,
                            description: repoForm.value.description
                        };
                        
                        // Ë∞ÉÁî®ÂêéÁ´ØAPI‰øùÂ≠ò‰ªìÂ∫ìÈÖçÁΩÆ
                        const response = await fetch('/api/repositories', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(systemConfig)
                        });
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            ElMessage.success('‰ªìÂ∫ìÊ∑ªÂä†ÊàêÂäüÔºÅ');
                            repoDialogVisible.value = false;
                            
                            // Âà∑Êñ∞Á≥ªÁªüÂàóË°®
                            await refreshSystems();
                        } else {
                            ElMessage.error('Ê∑ªÂä†‰ªìÂ∫ìÂ§±Ë¥•: ' + result.error);
                        }
                        
                    } catch (error) {
                        console.error('Ê∑ªÂä†‰ªìÂ∫ìÂ§±Ë¥•:', error);
                        ElMessage.error('Ê∑ªÂä†‰ªìÂ∫ìÂ§±Ë¥•: ' + error.message);
                    } finally {
                        repoFormLoading.value = false;
                    }
                };
                // Âà†Èô§‰ªìÂ∫ì
                const deleteRepository = async (id) => {
                    try {
                        const response = await fetch(`/api/repositories/${id}`, {
                            method: 'DELETE'
                        });

                        const result = await response.json();

                        if (result.success) {
                            ElMessage.success('‰ªìÂ∫ìÂà†Èô§ÊàêÂäüÔºÅ');
                            repoList.value = repoList.value.filter(item => item.id !== id);
                            // Âà∑Êñ∞Á≥ªÁªüÂàóË°®
                            await refreshSystems();
                        } else {
                            ElMessage.error('Âà†Èô§‰ªìÂ∫ìÂ§±Ë¥•: ' + result.error);
                        }

                    } catch (error) {
                        console.error('Âà†Èô§‰ªìÂ∫ìÂ§±Ë¥•:', error);
                        ElMessage.error('Âà†Èô§‰ªìÂ∫ìÂ§±Ë¥•: ' + error.message);
                    }
                };

                const openHistory = async () => {
                    showHistory.value = true;
                    await loadTasks();
                };
                const loadTasks = async () => {
                    historyLoading.value = true;
                    try {
                        const res = await axios.get('/api/tasks');
                        tasks.value = (res.data && res.data.tasks) || [];
                    } catch (e) {
                        ElMessage.error('Âä†ËΩΩÂéÜÂè≤‰ªªÂä°Â§±Ë¥•');
                    } finally {
                        historyLoading.value = false;
                    }
                };
                const viewTask = async (taskId) => {
                    try {
                        const res = await axios.get(`/api/task/${taskId}`);
                        currentTask.value = res.data;
                        activeTab.value = 'review';
                        showHistory.value = false;
                    } catch (e) {
                        ElMessage.error('Ëé∑Âèñ‰ªªÂä°ËØ¶ÊÉÖÂ§±Ë¥•');
                    }
                };

                // ÁîüÊàê‰ªªÂä°Êä•ÂëäURL
                const getTaskReportUrl = (taskId) => {
                    return `${window.location.origin}/report/${taskId}`;
                };

                // Â§çÂà∂‰ªªÂä°Êä•ÂëäÈìæÊé•
                const copyTaskReportUrl = async (taskId) => {
                    try {
                        const url = getTaskReportUrl(taskId);
                        
                        if (navigator.clipboard && window.isSecureContext) {
                            await navigator.clipboard.writeText(url);
                        } else {
                            // ÈôçÁ∫ßÂà∞‰º†ÁªüÊñπÂºè
                            const textArea = document.createElement('textarea');
                            textArea.value = url;
                            textArea.style.position = 'fixed';
                            textArea.style.left = '-999999px';
                            textArea.style.top = '-999999px';
                            document.body.appendChild(textArea);
                            textArea.focus();
                            textArea.select();
                            document.execCommand('copy');
                            textArea.remove();
                        }
                        
                        ElMessage.success(`Êä•ÂëäÈìæÊé•Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø`);
                    } catch (error) {
                        console.error('Â§çÂà∂ÈìæÊé•Â§±Ë¥•:', error);
                        ElMessage.error('Â§çÂà∂ÈìæÊé•Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂');
                        
                        // ÊòæÁ§∫ÈìæÊé•ËÆ©Áî®Êà∑ÊâãÂä®Â§çÂà∂
                        const url = getTaskReportUrl(taskId);
                        ElMessageBox.alert(url, '‰ªªÂä°Êä•ÂëäÈìæÊé•', {
                            confirmButtonText: 'Á°ÆÂÆö',
                            callback: () => {}
                        });
                    }
                };

                // Ëé∑ÂèñÁ≥ªÁªüÂàóË°®
                const loadSystems = async (forceRefresh = false) => {
                    console.log('üöÄ ÂºÄÂßãÂä†ËΩΩÁ≥ªÁªüÂàóË°®...');
                    systemsLoading.value = true;
                    clearError(); // Ê∏ÖÈô§‰πãÂâçÁöÑÈîôËØØ
                    
                    const result = await safeApiCall(async () => {
                        const params = forceRefresh ? { force_refresh: 'true' } : {};
                        return await axios.get('/api/systems', { params });
                    }, 'Âä†ËΩΩÁ≥ªÁªüÂàóË°®');
                    
                    if (result) {
                        try {
                            // Â§ÑÁêÜÂìçÂ∫îÊ†ºÂºè
                            if (result.data.systems) {
                                // Áõ¥Êé•‰øùÂ≠òÂéüÂßãÁ≥ªÁªüÊï∞ÊçÆÔºåÁî®‰∫éÂ±ÇÁ∫ßÂåñÊòæÁ§∫
                                systems.value = result.data.systems;
                                console.log('‚úÖ Á≥ªÁªüÊï∞ÊçÆÂ∑≤Âä†ËΩΩ:', systems.value.length, '‰∏™Á≥ªÁªü');

                                // Â§ÑÁêÜÂàÜÊîØÈÄâÈ°π
                                const branches = result.data.branches || [];
                            branchesOptionsList.value = branches.flatMap(item =>
                                Object.values(item)[0].map(b => {
                                    return { label: Object.keys(item)[0] + '/' + b.name, value: b.name }
                                })
                            );
                            console.log('‚úÖ ÂàÜÊîØÈÄâÈ°πÂ∑≤Âä†ËΩΩ:', branchesOptionsList.value.length, '‰∏™ÂàÜÊîØ');

                                // Â§ÑÁêÜ‰ªìÂ∫ìÊï∞ÊçÆ
                                repoList.value = result.data.repositories || [];
                            // Â§ÑÁêÜÊ¨°Êï∞ÈôêÂà∂
                            function formatUnix(ts) {
                              const d = new Date(ts * 1000);                // Áßí‚ÜíÊØ´Áßí
                              const pad = n => n.toString().padStart(2, '0');
                              return `${d.getFullYear()}-${
                                      pad(d.getMonth() + 1)}-${
                                      pad(d.getDate())} ${
                                      pad(d.getHours())}:${
                                      pad(d.getMinutes())}:${
                                      pad(d.getSeconds())}`;
                            }
                                if (result.data.rate_limit && result.data.rate_limit.reset) {
                                    rateLimitDescription.value = `ËÆøÈóÆÊ¨°Êï∞ÈôêÂà∂: ${result.data.rate_limit.limit}/h, Ââ©‰ΩôÊ¨°Êï∞: ${result.data.rate_limit.remaining}/h, ÈáçÁΩÆÊó∂Èó¥: ${formatUnix(result.data.rate_limit.reset)}`;
                                }
                                
                                // ÂàÜÊûêÁ≥ªÁªüÁä∂ÊÄÅ
                                const total = result.data.total;
                                const dynamicCount = systems.value.filter(s => s.dynamic).length;
                                const staticCount = systems.value.filter(s => !s.dynamic && !s.error).length;
                                const errorCount = systems.value.filter(s => s.error).length;
                                
                                // ÊòæÁ§∫Êï∞ÊçÆÊ∫ê‰ø°ÊÅØ
                                if (result.data.source === 'dynamic') {
                                console.log(`‚úÖ Âä®ÊÄÅËé∑ÂèñÁ≥ªÁªüÂàóË°®ÊàêÂäü: ${total} ‰∏™Á≥ªÁªü, ${dynamicCount} ‰∏™Êù•Ëá™API`);
                                
                                if (errorCount > 0) {
                                    // ÈÉ®ÂàÜÂ§±Ë¥• - ÊòæÁ§∫toastË≠¶Âëä
                                    ElMessage.warning(`${errorCount} ‰∏™Á≥ªÁªüËé∑ÂèñÂ§±Ë¥•ÔºåÂ∑≤‰ΩøÁî®ÈùôÊÄÅÈÖçÁΩÆ`);
                                    if (forceRefresh) {
                                        ElMessage.warning(`${errorCount} ‰∏™Á≥ªÁªüËé∑ÂèñÂ§±Ë¥•`);
                                    }
                                } else {
                                    // ÂÖ®ÈÉ®ÊàêÂäü - ÊòæÁ§∫ÊàêÂäütoast
                                    if (forceRefresh) {
                                        ElMessage.success(`Âà∑Êñ∞ÊàêÂäüÔºÅËé∑ÂèñÂà∞ ${total} ‰∏™Á≥ªÁªüÔºåÂ∑≤Ëá™Âä®Â§á‰ªΩÂà∞systems.yaml`);
                                    }
                                }
                                } else if (result.data.source === 'static_mode') {
                                    // ÈùôÊÄÅÈÖçÁΩÆ
                                    console.log(`üìã ‰ΩøÁî®ÈùôÊÄÅÈÖçÁΩÆ: ${result.data.total} ‰∏™Á≥ªÁªü`);
                                    ElMessage.info(`‰ΩøÁî®ÈùôÊÄÅÈÖçÁΩÆ`);
                                } else {
                                    // ÈùôÊÄÅÈÖçÁΩÆ
                                    console.log(`üìã ‰ΩøÁî®ÈùôÊÄÅÈÖçÁΩÆ: ${result.data.total} ‰∏™Á≥ªÁªü`);
                                    ElMessage.info(`‰ΩøÁî®ÈùôÊÄÅÈÖçÁΩÆÔºåÂª∫ËÆÆÊ£ÄÊü•ÁΩëÁªúËøûÊé•Êàñ API Token`);
                                    if (forceRefresh) {
                                        ElMessage.info(`‰ΩøÁî®ÈùôÊÄÅÈÖçÁΩÆ: ${result.data.total} ‰∏™Á≥ªÁªü`);
                                    }
                                }
                            } else {
                                // ÂÖºÂÆπÊóßÊ†ºÂºè
                                systems.value = result.data || [];
                                console.log('‚úÖ ÂÖºÂÆπÊ†ºÂºèÁ≥ªÁªüÊï∞ÊçÆÂ∑≤Âä†ËΩΩ:', systems.value.length, '‰∏™Á≥ªÁªü');
                            }
                        } catch (error) {
                            handleError(error, 'Â§ÑÁêÜÁ≥ªÁªüÊï∞ÊçÆ');
                            systems.value = [];
                        }
                    } else {
                        // Â¶ÇÊûú API Ë∞ÉÁî®Â§±Ë¥•Ôºå‰ΩøÁî®Á©∫Êï∞ÁªÑ‰Ωú‰∏∫ÈôçÁ∫ß
                        systems.value = [];
                        console.log('‚ö†Ô∏è ‰ΩøÁî®ÈôçÁ∫ßÊï∞ÊçÆ');
                    }
                    
                    systemsLoading.value = false;
                };

                const systemNames = computed(()  =>  {
                    const selectedSystemNames = selectedSystems.value.map(selected => {
                        // Â¶ÇÊûúÊòØÈ°πÁõÆÁ∫ßÈÄâÊã©ÔºàÊ†ºÂºèÔºösystem_name (project_name)ÔºâÔºåÂèñÁ≥ªÁªüÂêçÁß∞
                        if (selected.includes('(') && selected.includes(')')) {
                            const systemName = selected.split('(')[1].trim();
                            return systemName;
                        }
                        // Â¶ÇÊûúÊòØÊóßÊ†ºÂºèÔºàÊ†ºÂºèÔºösystem_name:project_nameÔºâÔºåÂèñÁ≥ªÁªüÂêçÁß∞
                        if (selected.includes(':')) {
                            return selected.split(':')[1];
                        }
                        // Âê¶ÂàôÂéªÈáçÂπ∂ËøîÂõû
                        return selected;
                    });
                    return [...new Set(selectedSystemNames)];
                });

                Vue.watch(systemNames, () => {
                    // ËøáÊª§Âá∫ÂΩìÂâçÈÄâÊã©ÁöÑÁ≥ªÁªüÁöÑÂàÜÊîØÈÄâÈ°π
                    const systemBranches = branchesOptionsList.value.filter(item => {
                        const lastSlash = item.label.lastIndexOf('/');
                        const systemName = lastSlash === -1 ? item.label : item.label.slice(0, lastSlash);
                        return systemNames.value.includes(systemName);
                    });

                    // Êõ¥Êñ∞ÂàÜÊîØÈÄâÈ°π
                    branchesOptions.value = systemBranches;
                }, { deep: true });
                
                // Âà∑Êñ∞Á≥ªÁªüÂàóË°®
                const refreshSystems = async () => {
                    await loadSystems(true);
                };

                // ÂºÄÂßãÂÆ°Êü•
                const startReview = async () => {
                    if (!systemNames.value.length || !branchName.value) {
                        ElMessage.warning('ËØ∑ÈÄâÊã©Á≥ªÁªüÂíåËæìÂÖ•ÂàÜÊîØÂêçÁß∞');
                        return;
                    }
                    
                    loading.value = true;
                    try {
                        // Â¶ÇÊûúÈÄâÊã©‰∫ÜÂ§ö‰∏™Á≥ªÁªüÔºåÊòæÁ§∫Á°ÆËÆ§‰ø°ÊÅØ
                        if (systemNames.value.length > 1) {
                            ElMessage.info(`Â∞ÜÂπ∂Ë°åÂ§ÑÁêÜ ${systemNames.value.length} ‰∏™Á≥ªÁªü: ${systemNames.value.join(', ')}`);
                        }

                        const response = await axios.post('/api/review-multi', {
                            system_names: systemNames.value,
                            branch_name: branchName.value
                        });
                        
                        currentTask.value = response.data;
                        activeTab.value = 'review';
                        
                        // Â§ÑÁêÜ‰ªªÂä°Â∑≤Â≠òÂú®ÁöÑÊÉÖÂÜµ
                        if (currentTask.value.existing) {
                            ElMessage.success(currentTask.value.message);
                            activeTab.value = 'review';
                        } else {
                            // ËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅÔºàÊîØÊåÅÂ§ö‰ªªÂä°Ôºâ
                            if (response.data.task_ids) {
                                // Â§öÁ≥ªÁªüÊÉÖÂÜµÔºåËΩÆËØ¢‰∏ª‰ªªÂä°ID
                                pollTaskStatus(response.data.main_task_id || response.data.task_ids[0]);
                            } else {
                                // ÂçïÁ≥ªÁªüÊÉÖÂÜµÔºå‰ΩøÁî®APIËøîÂõûÁöÑtask_id
                                pollTaskStatus(response.data.task_id);
                            }
                            
                            const successMsg = systemNames.value.length > 1
                                ? `${systemNames.value.length} ‰∏™Á≥ªÁªüÁöÑÂÆ°Êü•‰ªªÂä°Â∑≤ÂêØÂä®`
                                : 'ÂÆ°Êü•‰ªªÂä°Â∑≤ÂêØÂä®';
                            ElMessage.success(successMsg);
                        }
                    } catch (error) {
                        console.error('ÂºÄÂßãÂÆ°Êü•Â§±Ë¥•:', error);
                        ElMessage.error(error?.response?.data?.error || 'ÂºÄÂßãÂÆ°Êü•Â§±Ë¥•');
                    } finally {
                        loading.value = false;
                    }
                };
                
                // Á°ÆËÆ§‰∏≠Ê≠¢‰ªªÂä°
                const confirmAbortTask = () => {
                    if (!currentTask.value) {
                        ElMessage.error('Ê≤°ÊúâÂΩìÂâç‰ªªÂä°');
                        return;
                    }
                    
                    // Ê£ÄÊü•‰ªªÂä°Áä∂ÊÄÅÊòØÂê¶ÂÖÅËÆ∏‰∏≠Ê≠¢
                    if (currentTask.value.status === 'completed') {
                        ElMessage.info('‰ªªÂä°Â∑≤ÂÆåÊàêÔºåÊó†ÈúÄ‰∏≠Ê≠¢');
                        return;
                    }
                    
                    if (currentTask.value.status === 'failed') {
                        ElMessage.info('‰ªªÂä°Â∑≤Â§±Ë¥•ÔºåÊó†ÈúÄ‰∏≠Ê≠¢');
                        return;
                    }
                    
                    if (currentTask.value.status === 'aborted') {
                        ElMessage.info('‰ªªÂä°Â∑≤‰∏≠Ê≠¢');
                        return;
                    }
                    
                    // ÂÖºÂÆπAPIÂìçÂ∫îÊ†ºÂºè(task_id)Âíå‰ªªÂä°ËØ¶ÊÉÖÊ†ºÂºè(id)
                    const taskId = currentTask.value.id || currentTask.value.task_id || currentTask.value.main_task_id;
                    
                    if (!taskId) {
                        ElMessage.error('Êó†Ê≥ïËé∑Âèñ‰ªªÂä°ID');
                        return;
                    }
                    
                    ElMessageBox.confirm(
                        'Á°ÆÂÆöË¶Å‰∏≠Ê≠¢ÂΩìÂâç‰ªªÂä°ÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊí§ÈîÄ„ÄÇ',
                        '‰∏≠Ê≠¢‰ªªÂä°',
                        {
                            confirmButtonText: 'Á°ÆÂÆö‰∏≠Ê≠¢',
                            cancelButtonText: 'ÂèñÊ∂à',
                            type: 'warning',
                            confirmButtonClass: 'el-button--danger'
                        }
                    ).then(() => {
                        directAbortTask();
                    }).catch(() => {
                        ElMessage.info('Â∑≤ÂèñÊ∂à‰∏≠Ê≠¢Êìç‰Ωú');
                    });
                };
                
                // ‰∏≠Ê≠¢‰ªªÂä°
                const abortTask = async () => {
                    if (!currentTask.value) {
                        ElMessage.error('Ê≤°ÊúâÂΩìÂâç‰ªªÂä°');
                        return;
                    }
                    
                    // ÂÖºÂÆπAPIÂìçÂ∫îÊ†ºÂºè(task_id)Âíå‰ªªÂä°ËØ¶ÊÉÖÊ†ºÂºè(id)
                    const taskId = currentTask.value.id || currentTask.value.task_id || currentTask.value.main_task_id;
                    
                    if (!taskId) {
                        ElMessage.error('Êó†Ê≥ïËé∑Âèñ‰ªªÂä°ID');
                        return;
                    }
                    
                    abortLoading.value = true;
                    console.log('ÂºÄÂßãË∞ÉÁî®‰∏≠Ê≠¢APIÔºå‰ªªÂä°ID:', taskId);
                    
                    try {
                        const response = await axios.post(`/api/task/${taskId}/abort`);
                        console.log('‰∏≠Ê≠¢APIË∞ÉÁî®ÊàêÂäüÔºåÂìçÂ∫î:', response.data);
                        
                        ElMessage.success('‰ªªÂä°Â∑≤ÊàêÂäü‰∏≠Ê≠¢');
                        
                        // Á´ãÂç≥Êõ¥Êñ∞‰ªªÂä°Áä∂ÊÄÅ
                        console.log('Êõ¥Êñ∞ÂâçÁ´Ø‰ªªÂä°Áä∂ÊÄÅ‰∏∫aborted');
                        currentTask.value.status = 'aborted';
                        currentTask.value.updated_at = new Date().toISOString();
                        
                        // ÂÅúÊ≠¢ËΩÆËØ¢
                        if (pollTaskStatus.timer) {
                            console.log('ÂÅúÊ≠¢‰ªªÂä°Áä∂ÊÄÅËΩÆËØ¢');
                            clearTimeout(pollTaskStatus.timer);
                            pollTaskStatus.timer = null;
                        }
                        
                    } catch (error) {
                        console.error('‰∏≠Ê≠¢‰ªªÂä°Â§±Ë¥•:', error);
                        console.log('ËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ:', {
                            message: error.message,
                            status: error.response?.status,
                            statusText: error.response?.statusText,
                            data: error.response?.data,
                            url: error.config?.url,
                            method: error.config?.method,
                            taskId: taskId,
                            currentTask: currentTask.value
                        });
                        
                        // ÊòæÁ§∫Êõ¥ËØ¶ÁªÜÁöÑÈîôËØØ‰ø°ÊÅØ
                        if (error.response && error.response.data && error.response.data.error) {
                            ElMessage.error(`‰∏≠Ê≠¢‰ªªÂä°Â§±Ë¥•: ${error.response.data.error}`);
                            console.log('ÊúçÂä°Âô®ËøîÂõûÈîôËØØ:', error.response.data.error);
                        } else if (error.response?.status === 404) {
                            ElMessage.error('‰ªªÂä°‰∏çÂ≠òÂú®ÊàñÂ∑≤ÂÆåÊàê');
                            console.log('‰ªªÂä°‰∏çÂ≠òÂú®Ôºå‰ªªÂä°ID:', taskId);
                        } else if (error.response?.status === 400) {
                            ElMessage.error('‰ªªÂä°ÂΩìÂâçÁä∂ÊÄÅ‰∏çÂÖÅËÆ∏‰∏≠Ê≠¢');
                            console.log('‰ªªÂä°Áä∂ÊÄÅ‰∏çÂÖÅËÆ∏‰∏≠Ê≠¢ÔºåÂΩìÂâçÁä∂ÊÄÅ:', currentTask.value?.status);
                        } else if (error.code === 'NETWORK_ERROR' || !error.response) {
                            ElMessage.error('ÁΩëÁªúËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÊúçÂä°Âô®Áä∂ÊÄÅ');
                            console.log('ÁΩëÁªúÈîôËØØÔºåÊó†Ê≥ïËøûÊé•Âà∞ÊúçÂä°Âô®');
                        } else {
                            ElMessage.error(`‰∏≠Ê≠¢‰ªªÂä°Â§±Ë¥•: ${error.message || 'Êú™Áü•ÈîôËØØ'}`);
                            console.log('Êú™Áü•ÈîôËØØÁ±ªÂûã:', error);
                        }
                    } finally {
                        abortLoading.value = false;
                    }
                };
                
                // Áõ¥Êé•‰∏≠Ê≠¢‰ªªÂä°ÔºàÁé∞Âú®‰Ωú‰∏∫‰∏ªË¶ÅÂÆûÁé∞Ôºâ
                const directAbortTask = async () => {
                    if (!currentTask.value) {
                        ElMessage.error('Ê≤°ÊúâÂΩìÂâç‰ªªÂä°');
                        return;
                    }
                    
                    const taskId = currentTask.value.id || currentTask.value.task_id || currentTask.value.main_task_id;
                    
                    if (!taskId) {
                        ElMessage.error('Êó†Ê≥ïËé∑Âèñ‰ªªÂä°ID');
                        return;
                    }
                    
                    try {
                        abortLoading.value = true;
                        
                        const response = await axios.post(`/api/task/${taskId}/abort`);
                        
                        ElMessage.success('‰ªªÂä°Â∑≤ÊàêÂäü‰∏≠Ê≠¢');
                        
                        // Êõ¥Êñ∞‰ªªÂä°Áä∂ÊÄÅ
                        currentTask.value.status = 'aborted';
                        currentTask.value.updated_at = new Date().toISOString();
                        
                        // ÂÅúÊ≠¢ËΩÆËØ¢
                        if (pollTaskStatus.timer) {
                            clearTimeout(pollTaskStatus.timer);
                            pollTaskStatus.timer = null;
                        }
                        
                    } catch (error) {
                        console.error('‰∏≠Ê≠¢‰ªªÂä°Â§±Ë¥•:', error);
                        
                        if (error.response && error.response.data && error.response.data.error) {
                            ElMessage.error(`‰∏≠Ê≠¢‰ªªÂä°Â§±Ë¥•: ${error.response.data.error}`);
                        } else if (error.response?.status === 404) {
                            ElMessage.error('‰ªªÂä°‰∏çÂ≠òÂú®ÊàñÂ∑≤ÂÆåÊàê');
                        } else if (error.response?.status === 400) {
                            ElMessage.error('‰ªªÂä°ÂΩìÂâçÁä∂ÊÄÅ‰∏çÂÖÅËÆ∏‰∏≠Ê≠¢');
                        } else {
                            ElMessage.error(`‰∏≠Ê≠¢‰ªªÂä°Â§±Ë¥•: ${error.message || 'ËØ∑Á®çÂêéÈáçËØï'}`);
                        }
                        
                    } finally {
                        abortLoading.value = false;
                    }
                };
                
                // ËΩÆËØ¢‰ªªÂä°Áä∂ÊÄÅ
                const pollTaskStatus = async (taskId) => {
                    // Ê∏ÖÈô§‰πãÂâçÁöÑËΩÆËØ¢
                    if (pollTaskStatus.timer) {
                        clearTimeout(pollTaskStatus.timer);
                        pollTaskStatus.timer = null;
                    }
                    
                    const poll = async () => {
                        try {
                            const response = await axios.get(`/api/task/${taskId}`);
                            currentTask.value = response.data;
                            
                            // ‰ªªÂä°ÁªìÊùüÁä∂ÊÄÅÔºöÂ§±Ë¥•„ÄÅ‰∏≠Ê≠¢„ÄÅÂÆåÊàêÊó∂ÂÅúÊ≠¢ËΩÆËØ¢
                            if (currentTask.value.status === 'failed') {
                                const errorMsg = (currentTask.value.result && currentTask.value.result.error) || currentTask.value.error || '‰ªªÂä°Â§±Ë¥•';
                                
                                // Ê†πÊçÆÈîôËØØÁ±ªÂûãÊèê‰æõÂèãÂ•ΩÁöÑÊèêÁ§∫‰ø°ÊÅØ
                                let friendlyMsg = errorMsg;
                                if (errorMsg.includes('ÁΩëÁªúËøûÊé•Â§±Ë¥•') || errorMsg.includes('SSLÈîôËØØ')) {
                                    friendlyMsg = 'üåê ÁΩëÁªúËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÊàñÈÖçÁΩÆ‰ª£ÁêÜÂêéÈáçËØï';
                                } else if (errorMsg.includes('ÁΩëÁªúËøûÊé•Ë∂ÖÊó∂')) {
                                    friendlyMsg = '‚è∞ ÁΩëÁªúËøûÊé•Ë∂ÖÊó∂ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÂêéÈáçËØï';
                                } else if (errorMsg.includes('ÂàÜÊîØÊàñ‰ªìÂ∫ì‰∏çÂ≠òÂú®')) {
                                    friendlyMsg = 'üîç ÂàÜÊîØÊàñ‰ªìÂ∫ì‰∏çÂ≠òÂú®ÔºåËØ∑Ê£ÄÊü•ÂàÜÊîØÂêçÁß∞ÊòØÂê¶Ê≠£Á°Æ';
                                } else if (errorMsg.includes('Git APIË∞ÉÁî®Â§±Ë¥•')) {
                                    friendlyMsg = 'üîß Git APIË∞ÉÁî®Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØïÊàñËÅîÁ≥ªÁÆ°ÁêÜÂëò';
                                }
                                
                                ElMessage({
                                    message: friendlyMsg,
                                    type: 'error',
                                    duration: 5000,
                                    showClose: true
                                });
                                return;
                            }
                            
                            // ‰ªªÂä°Ë¢´‰∏≠Ê≠¢Êó∂ÊèêÁ§∫Âπ∂ÂÅúÊ≠¢ËΩÆËØ¢
                            if (currentTask.value.status === 'aborted') {
                                ElMessage({
                                    message: 'üõë ‰ªªÂä°Â∑≤Ë¢´‰∏≠Ê≠¢',
                                    type: 'warning',
                                    duration: 3000,
                                    showClose: true
                                });
                                return;
                            }
                            
                            // ‰ªªÂä°ÂÆåÊàêÊó∂ÂÅúÊ≠¢ËΩÆËØ¢
                            if (currentTask.value.status === 'completed') {
                                ElMessage({
                                    message: '‚úÖ ‰ªªÂä°Â∑≤ÂÆåÊàê',
                                    type: 'success',
                                    duration: 3000,
                                    showClose: true
                                });
                                return;
                            }

                            if (currentTask.value.status === 'pending' || currentTask.value.status === 'processing') {
                                pollTaskStatus.timer = setTimeout(poll, 2000);
                            }
                        } catch (error) {
                            console.error('Ëé∑Âèñ‰ªªÂä°Áä∂ÊÄÅÂ§±Ë¥•:', error);
                            ElMessage.error('Ëé∑Âèñ‰ªªÂä°Áä∂ÊÄÅÂ§±Ë¥•');
                        }
                    };
                    
                    poll();
                };
                
                // Ëé∑Âèñ‰∏•ÈáçÁ®ãÂ∫¶Á±ªÂûã
                const getSeverityType = (severity) => {
                    const types = {
                        'Critical': '#ef4444',
                        'High': '#f59e0b',
                        'Medium': '#06b6d4',
                        'Low': '#10b981'
                    };
                    return types[severity] || '#06b6d4';
                };
                const getStatusTagType = (status) => {
                    const m = { 'completed': 'success', 'failed': 'danger', 'processing': 'warning', 'pending': 'info' };
                    return m[status] || 'info';
                };
                
                // Â§çÂà∂‰ª£Á†Å
                const copyCode = (code) => {
                    navigator.clipboard.writeText(code).then(() => {
                        ElMessage.success('‰ª£Á†ÅÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                    }).catch(() => {
                        ElMessage.error('Â§çÂà∂Â§±Ë¥•');
                    });
                };
                
                // ÂõæË°®Áõ∏ÂÖ≥
                const charts = ref({});
                
                const initializeCharts = () => {
                    if (!currentTask.value?.result?.statistics) return;
                    
                    const taskId = currentTask.value.id;
                    const stats = currentTask.value.result.statistics;
                    
                    // ÈîÄÊØÅÂ∑≤Â≠òÂú®ÁöÑÂõæË°®
                    Object.values(charts.value).forEach(chart => {
                        if (chart && typeof chart.destroy === 'function') {
                            chart.destroy();
                        }
                    });
                    charts.value = {};
                    
                    // Á≠âÂæÖDOMÊõ¥Êñ∞
                    Vue.nextTick(() => {
                        try {
                            // ‰∏•ÈáçÁ®ãÂ∫¶ÂàÜÂ∏ÉÈ•ºÂõæ
                            const severityCanvas = document.getElementById(`severityChart-${taskId}`);
                            if (severityCanvas && stats.review_statistics?.severity_counts) {
                                const severityCtx = severityCanvas.getContext('2d');
                                const severityData = stats.review_statistics.severity_counts;

                                const colorMap = {
                                  Critical: '#ef4444',
                                  High:     '#f59e0b',
                                  Medium:   '#06b6d4',
                                  Low:      '#10b981'
                                };
                                const labels = ['Critical', 'High', 'Medium', 'Low'].filter(k => severityData[k]);
                                const data   = labels.map(k => severityData[k]);
                                const backgroundColor = labels.map(k => colorMap[k]);
                                
                                charts.value.severity = new Chart(severityCtx, {
                                    type: 'doughnut',
                                    data: {
                                        labels,
                                        datasets: [{
                                            data,
                                            backgroundColor,
                                            borderWidth: 2,
                                            borderColor: '#fff'
                                        }]
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        plugins: {
                                            legend: {
                                                position: 'bottom',
                                                labels: {
                                                    padding: 20,
                                                    usePointStyle: true
                                                }
                                            }
                                        }
                                    }
                                });
                                //console.log('charts.value.severity:', charts.value.severity);
                            }
                            
                            // ÈóÆÈ¢òÁ±ªÂûãÊü±Áä∂Âõæ
                            const categoryCanvas = document.getElementById(`categoryChart-${taskId}`);
                            if (categoryCanvas && stats.review_statistics?.category_counts) {
                                const categoryCtx = categoryCanvas.getContext('2d');
                                const categoryData = stats.review_statistics.category_counts;
                                
                                charts.value.category = new Chart(categoryCtx, {
                                    type: 'bar',
                                    data: {
                                        labels: Object.keys(categoryData),
                                        datasets: [{
                                            label: 'ÈóÆÈ¢òÊï∞Èáè',
                                            data: Object.values(categoryData),
                                            backgroundColor: '#6366f1',
                                            borderColor: '#4f46e5',
                                            borderWidth: 1,
                                            borderRadius: 4
                                        }]
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        plugins: {
                                            legend: {
                                                display: false
                                            }
                                        },
                                        scales: {
                                            y: {
                                                beginAtZero: true,
                                                ticks: {
                                                    stepSize: 1
                                                }
                                            },
                                            x: {
                                                ticks: {
                                                    maxTicksLimit: 6
                                                }
                                            }
                                        }
                                    }
                                });
                            }
                        } catch (error) {
                            console.error('ÂàùÂßãÂåñÂõæË°®Â§±Ë¥•:', error);
                        }
                    });
                };
                
                // ÁõëÂê¨currentTaskÂèòÂåñÔºåËá™Âä®Êõ¥Êñ∞ÂõæË°®
                const watchCurrentTask = Vue.watch(
                    () => currentTask.value?.status === 'completed' && currentTask.value?.result?.statistics,
                    (hasStats) => {
                        if (hasStats) {
                            setTimeout(initializeCharts, 500); // Âª∂ËøüÁ°Æ‰øùDOMÂ∑≤Ê∏≤Êüì
                        }
                    }
                );
                
                // ÁõëÂê¨Á≥ªÁªüÈÄâÊã©ÂèòÂåñÔºåÊ∏ÖÈô§ÂΩìÂâç‰ªªÂä°ÁªìÊûúÂπ∂Âä†ËΩΩÂàÜÊîØ
                const watchSelectedSystems = Vue.watch(
                    selectedSystems,
                    (newSystems, oldSystems) => {
                        // Â¶ÇÊûúÁ≥ªÁªüÈÄâÊã©ÂèëÁîüÂèòÂåñÔºåÊ∏ÖÈô§ÂΩìÂâç‰ªªÂä°
                        if (JSON.stringify(newSystems) !== JSON.stringify(oldSystems)) {
                            currentTask.value = null;
                        }
                    }
                );
                
                // Ê†ºÂºèÂåñÊó•ÊúüÊó∂Èó¥‰∏∫ Âπ¥/Êúà/Êó• Êó∂:ÂàÜ:Áßí
                const formatDateTime = (dateTimeStr) => {
                    if (!dateTimeStr) return 'Êó†';
                    try {
                        const date = new Date(dateTimeStr);
                        const year = date.getFullYear();
                        const month = String(date.getMonth() + 1).padStart(2, '0');
                        const day = String(date.getDate()).padStart(2, '0');
                        const hours = String(date.getHours()).padStart(2, '0');
                        const minutes = String(date.getMinutes()).padStart(2, '0');
                        const seconds = String(date.getSeconds()).padStart(2, '0');
                        return `${year}/${month}/${day} ${hours}:${minutes}:${seconds}`;
                    } catch (e) {
                        return dateTimeStr;
                    }
                };

                // Ê†ºÂºèÂåñÂ∏¶Êç¢Ë°åÁöÑÊñáÊú¨
                const formatTextWithLineBreaks = (text) => {
                    if (!text) return '';
                    
                    // Â§ÑÁêÜÂêÑÁßçÊç¢Ë°åÁ¨¶Ê†ºÂºè
                    return text
                        .replace(/\\n/g, '\n')          // ËΩ¨Êç¢ \n ‰∏∫ÁúüÂÆûÊç¢Ë°å
                        .replace(/\r\n/g, '\n')         // Áªü‰∏ÄÊç¢Ë°åÁ¨¶
                        .replace(/\r/g, '\n')           // Áªü‰∏ÄÊç¢Ë°åÁ¨¶
                        .replace(/\n\n+/g, '\n\n')      // ÂêàÂπ∂Â§ö‰∏™ËøûÁª≠Êç¢Ë°å‰∏∫ÂèåÊç¢Ë°å
                        .trim();                        // ÂéªÈô§È¶ñÂ∞æÁ©∫ÁôΩ
                };
                
                // Ëé∑Âèñ‰ªªÂä°ËøõÂ∫¶ÁôæÂàÜÊØî
                const getTaskProgress = (task) => {
                    if (!task) return 0;
                    
                    if (task.status === 'completed') return 100;
                    if (task.status === 'failed') return 100;
                    if (task.status === 'aborted') return 100;
                    if (task.status === 'pending') return 0;
                    
                    if (task.status === 'processing') {
                        // ‰ºòÂÖà‰ΩøÁî®file_statesËÆ°ÁÆóÁ≤æÁ°ÆËøõÂ∫¶
                        const fileStates = task.file_states || {};
                        const fileNames = Object.keys(fileStates);
                        
                        if (fileNames.length > 0) {
                            let totalSubtasks = 0;
                            let completedSubtasks = 0;
                            
                            // ÁªüËÆ°ÊØè‰∏™Êñá‰ª∂ÁöÑÂ≠ê‰ªªÂä°Áä∂ÊÄÅ
                            fileNames.forEach(filename => {
                                const fileState = fileStates[filename];
                                
                                // ÊØè‰∏™Êñá‰ª∂Êúâ3‰∏™Â≠ê‰ªªÂä°Ôºöreview, unit_test, scenario_test
                                totalSubtasks += 3;
                                
                                if (fileState.review_status === 'completed') completedSubtasks++;
                                if (fileState.unit_test_status === 'completed') completedSubtasks++;
                                if (fileState.scenario_test_status === 'completed') completedSubtasks++;
                            });
                            
                            if (totalSubtasks > 0) {
                                const progress = (completedSubtasks / totalSubtasks) * 100;
                                return Math.min(progress, 95); // ÊúÄÂ§ß95%ÔºåÁïô5%ÁªôÊúÄÁªàÊï¥ÁêÜ
                            }
                        }
                        
                        // ÈôçÁ∫ßÔºöÂü∫‰∫édebug_logÂàÜÊûêÊñá‰ª∂Â§ÑÁêÜËøõÂ∫¶
                        const debugLog = task.debug_log || [];
                        
                        // Êü•ÊâæÊñá‰ª∂Êï∞Èáè‰ø°ÊÅØ
                        let totalFiles = 0;
                        let processedFiles = 0;
                        
                        // ‰ªédebug_log‰∏≠ÊèêÂèñÊñá‰ª∂Êï∞Èáè‰ø°ÊÅØ
                        debugLog.forEach(log => {
                            if (typeof log === 'string') {
                                // Êü•Êâæ "ËΩ¨Êç¢ÂêéË∞ÉÁî®_process_project: dify, X‰∏™Êñá‰ª∂"
                                const filesMatch = log.match(/ËΩ¨Êç¢ÂêéË∞ÉÁî®_process_project:.*?(\d+)‰∏™Êñá‰ª∂/);
                                if (filesMatch) {
                                    totalFiles = parseInt(filesMatch[1]);
                                }
                                
                                // Êü•Êâæ "ÂèëÁé∞ X ‰∏™Êñá‰ª∂ÂèòÊõ¥" (Â§áÁî®Ê®°Âºè)
                                const altFilesMatch = log.match(/ÂèëÁé∞\s+(\d+)\s+‰∏™Êñá‰ª∂ÂèòÊõ¥/);
                                if (altFilesMatch) {
                                    totalFiles = parseInt(altFilesMatch[1]);
                                }
                                
                                // Êü•ÊâæÂêÑÁßçÊñá‰ª∂Â§ÑÁêÜÂÆåÊàêÁöÑÊ®°Âºè
                                if (log.includes('Êñá‰ª∂Â§ÑÁêÜÂÆåÊàê') || 
                                    log.includes('AsyncProcessor Êñá‰ª∂Â§ÑÁêÜÂÆåÊàê') ||
                                    log.includes('_process_fileÂÆåÊàê')) {
                                    processedFiles++;
                                }
                            }
                        });
                        
                        // Ê£ÄÊü•ÊòØÂê¶ÊúâÁªìÊûúÊï∞ÊçÆÊù•Êé®Êñ≠ËøõÂ∫¶
                        const result = task.result || {};
                        const reportCount = (result.report && result.report.length) || 0;
                        const reviewCount = (result.review_results && result.review_results.length) || 0;
                        const unitCount = (result.unit_cases && result.unit_cases.length) || 0;
                        const scenarioCount = (result.scenario_cases && result.scenario_cases.length) || 0;
                        
                        if (totalFiles > 0) {
                            // Â¶ÇÊûúÊúâÊñá‰ª∂Êï∞Èáè‰ø°ÊÅØÔºå‰ºòÂÖà‰ΩøÁî®Êñá‰ª∂ËøõÂ∫¶
                            if (processedFiles > 0) {
                                const fileProgress = (processedFiles / totalFiles) * 100;
                                return Math.min(fileProgress, 95);
                            }
                            // Â¶ÇÊûúÊúâÁªìÊûúÊï∞ÊçÆ‰ΩÜÊ≤°ÊúâÊñá‰ª∂ÂÆåÊàêÊó•ÂøóÔºåÂü∫‰∫éÁªìÊûúÊé®Êñ≠
                            else if (reportCount > 0 || reviewCount > 0 || unitCount > 0 || scenarioCount > 0) {
                                // ÊúâÁªìÊûúËØ¥ÊòéÊñá‰ª∂Â§ÑÁêÜÊé•ËøëÂÆåÊàêÔºåËøîÂõûÈ´òËøõÂ∫¶
                                return 85;
                            }
                            else {
                                // ÊúâÊñá‰ª∂Êï∞Èáè‰ΩÜËøòÊ≤°ÊúâÁªìÊûú
                                return 25;
                            }
                        } else {
                            // Ê≤°ÊúâÊñá‰ª∂Êï∞Èáè‰ø°ÊÅØÊó∂ÔºåÂü∫‰∫éÂ≠ê‰ªªÂä°ÂÆåÊàêÊÉÖÂÜµËÆ°ÁÆóËøõÂ∫¶
                            let completedSubtasks = 0;
                            let totalSubtasks = 3; // ÂÆ°Êü•„ÄÅÂçïÂÖÉÊµãËØï„ÄÅÂú∫ÊôØÊµãËØï
                            
                            if (reportCount > 0 || reviewCount > 0) completedSubtasks++;
                            if (unitCount > 0) completedSubtasks++;
                            if (scenarioCount > 0) completedSubtasks++;
                            
                            // Âü∫‰∫éÂÆåÊàêÁöÑÂ≠ê‰ªªÂä°ËÆ°ÁÆóËøõÂ∫¶
                            const subtaskProgress = (completedSubtasks / totalSubtasks) * 100;
                            return Math.min(subtaskProgress, 95);
                        }
                    }
                    return 0;
                };
                
                // ÊñáÊú¨Êà™Êñ≠ÂáΩÊï∞
                const truncateText = (text, maxLength) => {
                    if (!text) return '';
                    if (text.length <= maxLength) return text;
                    return text.substring(0, maxLength - 3) + '...';
                };

                // Ê†ºÂºèÂåñÁ≥ªÁªüÊ†áÁ≠æ
                const formatSystemLabel = (system) => {
                    if (!system) return '';
                    
                    // Á≥ªÁªüÁ∫ßÈÄâÈ°πÊòæÁ§∫Á≥ªÁªüÂêçÁß∞ÂíåÈ°πÁõÆÊï∞Èáè
                    if (system.project_count > 1) {
                        return `${system.name} (${system.project_count}‰∏™È°πÁõÆ)`;
                    }
                    
                    return system.name;
                };

                // Ëé∑Âèñ‰ªªÂä°ËøõÂ∫¶ÊñáÊú¨
                const getTaskProgressText = (task) => {
                    if (!task) return 'ÂáÜÂ§á‰∏≠...';
                    
                    switch (task.status) {
                        case 'pending':
                            return 'üìã ‰ªªÂä°ÊéíÈòü‰∏≠ÔºåËØ∑Á®çÂÄô...';
                        case 'processing':
                            // ‰ºòÂÖà‰ΩøÁî®file_statesÊòæÁ§∫Á≤æÁ°ÆÁöÑÂ≠ê‰ªªÂä°ËøõÂ∫¶
                            const fileStates = task.file_states || {};
                            const fileNames = Object.keys(fileStates);
                            
                            if (fileNames.length > 0) {
                                let totalSubtasks = 0;
                                let completedSubtasks = 0;
                                let reviewCompleted = 0;
                                let unitCompleted = 0;
                                let scenarioCompleted = 0;
                                
                                // ÁªüËÆ°ÊØè‰∏™Êñá‰ª∂ÁöÑÂ≠ê‰ªªÂä°Áä∂ÊÄÅ
                                fileNames.forEach(filename => {
                                    const fileState = fileStates[filename];
                                    totalSubtasks += 3;
                                    
                                    if (fileState.review_status === 'completed') {
                                        completedSubtasks++;
                                        reviewCompleted++;
                                    }
                                    if (fileState.unit_test_status === 'completed') {
                                        completedSubtasks++;
                                        unitCompleted++;
                                    }
                                    if (fileState.scenario_test_status === 'completed') {
                                        completedSubtasks++;
                                        scenarioCompleted++;
                                    }
                                });
                                
                                const progress = Math.round((completedSubtasks / totalSubtasks) * 100);
                                
                                // Ê†πÊçÆÂÆåÊàêÁöÑÂ≠ê‰ªªÂä°Á±ªÂûãÊòæÁ§∫ËØ¶ÁªÜËøõÂ∫¶
                                const completedTypes = [];
                                if (reviewCompleted > 0) completedTypes.push(`‰ª£Á†ÅÂÆ°Êü•(${reviewCompleted}/${fileNames.length})`);
                                if (unitCompleted > 0) completedTypes.push(`ÂçïÂÖÉÊµãËØï(${unitCompleted}/${fileNames.length})`);
                                if (scenarioCompleted > 0) completedTypes.push(`Âú∫ÊôØÊµãËØï(${scenarioCompleted}/${fileNames.length})`);
                                
                                if (completedTypes.length === 0) {
                                    return `üîç Ê≠£Âú®ÂàÜÊûê ${fileNames.length} ‰∏™Êñá‰ª∂...`;
                                } else if (progress >= 95) {
                                    return `üéØ Âç≥Â∞ÜÂÆåÊàêÔºåÊ≠£Âú®Êï¥ÁêÜÁªìÊûú... (${progress}%)`;
                                } else {
                                    return `üìä ${completedTypes.join('„ÄÅ')} | ÊÄªËøõÂ∫¶: ${progress}%`;
                                }
                            }
                            
                            // ÈôçÁ∫ßÔºöÂü∫‰∫édebug_logÂàÜÊûêÊñá‰ª∂Â§ÑÁêÜËøõÂ∫¶
                            const debugLog = task.debug_log || [];
                            
                            let totalFiles = 0;
                            let processedFiles = 0;
                            
                            // ‰ªédebug_log‰∏≠ÊèêÂèñÊñá‰ª∂Â§ÑÁêÜ‰ø°ÊÅØ
                            debugLog.forEach(log => {
                                if (typeof log === 'string') {
                                    // Êü•Êâæ "ËΩ¨Êç¢ÂêéË∞ÉÁî®_process_project: dify, X‰∏™Êñá‰ª∂"
                                    const filesMatch = log.match(/ËΩ¨Êç¢ÂêéË∞ÉÁî®_process_project:.*?(\d+)‰∏™Êñá‰ª∂/);
                                    if (filesMatch) {
                                        totalFiles = parseInt(filesMatch[1]);
                                    }
                                    
                                    // Êü•Êâæ "ÂèëÁé∞ X ‰∏™Êñá‰ª∂ÂèòÊõ¥" (Â§áÁî®Ê®°Âºè)
                                    const altFilesMatch = log.match(/ÂèëÁé∞\s+(\d+)\s+‰∏™Êñá‰ª∂ÂèòÊõ¥/);
                                    if (altFilesMatch) {
                                        totalFiles = parseInt(altFilesMatch[1]);
                                    }
                                    
                                    // Êü•ÊâæÂêÑÁßçÊñá‰ª∂Â§ÑÁêÜÂÆåÊàêÁöÑÊ®°Âºè
                                    if (log.includes('Êñá‰ª∂Â§ÑÁêÜÂÆåÊàê') || 
                                        log.includes('AsyncProcessor Êñá‰ª∂Â§ÑÁêÜÂÆåÊàê') ||
                                        log.includes('_process_fileÂÆåÊàê')) {
                                        processedFiles++;
                                    }
                                }
                            });
                            
                            if (totalFiles > 0) {
                                const percentage = Math.round((processedFiles / totalFiles) * 100);
                                return `üîÑ Ê≠£Âú®Â§ÑÁêÜÊñá‰ª∂ ${processedFiles}/${totalFiles} (${percentage}%)`;
                            } else {
                                // fallbackÂà∞Âü∫‰∫éÂ≠ê‰ªªÂä°ÁªìÊûúÁöÑÊòæÁ§∫
                                const result = task.result || {};
                                const reportCount = (result.report && result.report.length) || 0;
                                const reviewCount = (result.review_results && result.review_results.length) || 0;
                                const unitCount = (result.unit_cases && result.unit_cases.length) || 0;
                                const scenarioCount = (result.scenario_cases && result.scenario_cases.length) || 0;
                                
                                const completedTasks = [];
                                if (reportCount > 0 || reviewCount > 0) completedTasks.push('‰ª£Á†ÅÂÆ°Êü•');
                                if (unitCount > 0) completedTasks.push('ÂçïÂÖÉÊµãËØï');
                                if (scenarioCount > 0) completedTasks.push('Âú∫ÊôØÊµãËØï');
                                
                                if (completedTasks.length === 0) {
                                    return 'üîç Ê≠£Âú®Ëé∑Âèñ‰ª£Á†ÅÂ∑ÆÂºÇ...';
                                } else if (completedTasks.length === 3) {
                                    return 'üéØ Ê≠£Âú®ÂÆåÊàêÊúÄÁªàÊï¥ÁêÜ...';
                                } else {
                                    const remaining = ['‰ª£Á†ÅÂÆ°Êü•', 'ÂçïÂÖÉÊµãËØï', 'Âú∫ÊôØÊµãËØï']
                                        .filter(task => !completedTasks.includes(task));
                                    const progress = Math.round((completedTasks.length / 3) * 100);
                                    return `üöÄ Â∑≤ÂÆåÊàê: ${completedTasks.join('„ÄÅ')} (${progress}%) | ËøõË°å‰∏≠: ${remaining[0] || 'ÂÆåÊàê'}`;
                                }
                            }
                        case 'completed':
                            return '‚úÖ ‰ªªÂä°ÂÆåÊàê';
                        case 'failed':
                            return '‚ùå ‰ªªÂä°Â§±Ë¥•';
                        case 'aborted':
                            return 'üõë ‰ªªÂä°Â∑≤‰∏≠Ê≠¢';
                        default:
                            return '‚ùì Êú™Áü•Áä∂ÊÄÅ';
                    }
                };

                // Ê†ºÂºèÂåñÊµãËØïÊèèËø∞
                const formatTestDescription = (description) => {
                    if (!description) return '';
                    
                    // Â∞ÜÊèèËø∞ÊåâË°åÂàÜÂâ≤Â§ÑÁêÜ
                    let formatted = description
                        .replace(/\\n/g, '\n')  // ÂÖàÁªü‰∏ÄÊç¢Ë°åÁ¨¶
                        .split('\n')
                        .map(line => line.trim())
                        .filter(line => line.length > 0)
                        .map(line => {
                            // Â§ÑÁêÜÁºñÂè∑Ë°å
                            if (/^\d+\./.test(line)) {
                                const match = line.match(/^(\d+)\.?\s*(.+)$/);
                                if (match) {
                                    return `<div class="test-step"><strong>${match[1]}.</strong> ${match[2]}</div>`;
                                }
                            }
                            // ÊôÆÈÄöË°å
                            return `<div class="test-line">${line}</div>`;
                        })
                        .join('');
                    
                    // ‰∏çÂÜçÈ´ò‰∫ÆÂÖ≥ÈîÆËØçÔºå‰øùÊåÅÂéüÂßãÊèèËø∞
                    return formatted;
                };

                function getPercentage(val,filestatus){
                    console.log(val,filestatus);
                    return (val / (filestatus.additions + filestatus.deletions + filestatus.changes)) * 100;
                };

                onMounted(() => {
                    console.log('üéØ ÁªÑ‰ª∂Â∑≤ÊåÇËΩΩÔºåÂºÄÂßãÂàùÂßãÂåñ...');

                    // Ëé∑ÂèñÈìæÊé•report/taskIdÁöÑ‰ªªÂä°IDÂèÇÊï∞http://localhost:5002/report/e37f9f66-10ca-4337-a017-91f58903b1c3
                    reportId.value = location.href.split('/').pop();
                    
                    // ÂêØÂä®ÂÜÖÂ≠òÁõëÊéß
                    startMemoryMonitoring();
                    updateMemoryUsage();
                    
                    // ËÆæÁΩÆÂÖ®Â±ÄÈîôËØØÂ§ÑÁêÜ
                    window.addEventListener('error', (event) => {
                        handleError(event.error, 'ÂÖ®Â±ÄÈîôËØØ', false);
                    });
                    
                    window.addEventListener('unhandledrejection', (event) => {
                        handleError(event.reason, 'Êú™Â§ÑÁêÜÁöÑPromiseÊãíÁªù', false);
                    });

                    if (reportId.value) {
                        document.title = `‰ªªÂä°Êä•Âëä - ${reportId.value}`;
                        viewTask(reportId.value)
                        console.log('üîç ÂèëÁé∞‰ªªÂä°IDÂèÇÊï∞ÔºåÂ∞ùËØïÂä†ËΩΩ‰ªªÂä°...');
                    } else {
                        console.log('üîç Êú™ÂèëÁé∞‰ªªÂä°IDÂèÇÊï∞ÔºåÊ≠£Âú®Âä†ËΩΩÁ≥ªÁªüÂàóË°®...');
                        loadSystems();
                    }
                    
                    console.log('‚úÖ ÂàùÂßãÂåñÂÆåÊàê');
                });
                
                return {
                    systems,
                    selectedSystems,
                    branchesOptions,
                    switchBranch,
                    branchName,
                    systemsLoading,
                    rateLimitDescription,
                    loading,
                    currentTask,
                    activeTab,
                    form,
                    // ÂéÜÂè≤ÂÖ•Âè£
                    showHistory,
                    historyLoading,
                    tasks,
                    keyword,
                    debouncedKeyword,
                    debouncedSearch,
                    filteredTasks,
                    groupedScenarioCases,
                    // ÊÄßËÉΩ‰ºòÂåñ
                    hasValidSystems,
                    selectedSystemsCount,
                    isTaskRunning,
                    taskProgressPercent,
                    treeData,
                    // ËôöÊãüÊªöÂä®
                    virtualListConfig,
                    visibleTasksRange,
                    visibleTasks,
                    virtualContainerHeight,
                    virtualOffsetY,
                    handleVirtualScroll,
                    // ÈîôËØØÂ§ÑÁêÜ
                    errorState,
                    handleError,
                    clearError,
                    // ÂÜÖÂ≠òÁÆ°ÁêÜ
                    memoryUsage,
                    updateMemoryUsage,
                    cleanupMemory,
                    openHistory,
                    loadTasks,
                    viewTask,
                    getTaskReportUrl,
                    copyTaskReportUrl,
                    // ÈÄöÁü•ÈÖçÁΩÆ
                    notificationDialogVisible,
                    notificationLoading,
                    savingConfig,
                    testingNotification,
                    newEmailRecipient,
                    newWechatMention,
                    notificationConfig,
                    canTestNotification,
                    openNotificationConfig,
                    loadNotificationConfig,
                    saveNotificationConfig,
                    testNotification,
                    isValidEmail,
                    addEmailRecipient,
                    removeEmailRecipient,
                    addWechatMention,
                    removeWechatMention,
                    // ‰ªìÂ∫ìÂΩïÂÖ•
                    repoDialogVisible,
                    repoFormLoading,
                    repoForm,
                    openRepoDialog,
                    parseGitUrl,
                    addRepository,
                    deleteRepository,
                    refreshSystems,
                    repoList,
                    // ‰ªªÂä°Êìç‰Ωú
                    startReview,
                    abortLoading,
                    confirmAbortTask,
                    abortTask,
                    directAbortTask,


                    // ÂÖ∂ÂÆÉ
                    getSeverityType,
                    getStatusTagType,
                    copyCode,
                    formatTestDescription,
                    formatTextWithLineBreaks,
                    formatDateTime,
                    getTaskProgress,
                    getTaskProgressText,
                    formatSystemLabel,
                    truncateText,
                    getPercentage,
                    reportId,
                    // ÁõëÂê¨Âô®
                    watchSelectedSystems
                };
            }
        });
        // Ê≥®ÂÜåÊàêÂÖ®Â±ÄÁªÑ‰ª∂
        app.component('Refresh', Refresh);
        app.component('Clock', Clock);
        app.component('Plus', Plus);
        app.component('Message', Message);
        app.component('View', View);
        app.component('Close', Close);
        app.component('Warning', Warning);
        app.component('Check', Check);
        app.component('Search', Search);
        app.component('Edit', Edit);
        app.component('Guide', Guide);
        app.component('Key', Key);
        app.component('Monitor', Monitor);
        app.component('Grid', Grid);
        app.component('Link', Link);
        app.component('Loading', Loading);
        app.component('Document', Document);
        app.component('CirclePlusFilled', CirclePlusFilled);
        app.component('RemoveFilled', RemoveFilled);
        app.use(ElementPlus).mount('#app');
    </script>
</body>
</html>
